/*! iam 2.8.8: 2025-09-15 */
window.iamInitialized||(IOL=window.IOL||{},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var a=Object(this),d=a.length>>>0,t=arguments[1],o=0;o!==d;o++)if(e.call(t,this[o],o,a))return this[o]}}),Array.prototype.filter||(Array.prototype.filter=function(e){if(null==this)throw new TypeError;var a=Object(this),d=a.length>>>0;if("function"!=typeof e)throw new TypeError;for(var t,o=[],i=2<=arguments.length?arguments[1]:void 0,n=0;n<d;n++)n in a&&(t=a[n],e.call(i,t,n,a))&&o.push(t);return o}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,value:function(a){return 0<this.filter(function(e){return e==a}).length}}),Object.keys||(Object.keys=(()=>{var o=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],s=n.length;return function(e){if("function"!=typeof e&&("object"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var a,d,t=[];for(a in e)o.call(e,a)&&t.push(a);if(i)for(d=0;d<s;d++)o.call(e,n[d])&&t.push(n[d]);return t}})()),Object.entries||(Object.entries=function(e){for(var a=Object.keys(e),d=a.length,t=new Array(d);d--;)t[d]=[a[d],e[a[d]]];return t}),Array.prototype.forEach||(Array.prototype.forEach=function(e){var a,d;if(null==this)throw new TypeError("this is null or not defined");var t,o=Object(this),i=o.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(1<arguments.length&&(a=arguments[1]),d=0;d<i;)d in o&&(t=o[d],e.call(a,t,d,o)),d++}),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e,a){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var d=Object(e),t=1;t<arguments.length;t++){var o=arguments[t];if(null!=o)for(var o=Object(o),i=Object.keys(Object(o)),n=0,s=i.length;n<s;n++){var r=i[n],l=Object.getOwnPropertyDescriptor(o,r);void 0!==l&&l.enumerable&&(d[r]=o[r])}}return d}}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,a){a=0<a?0|a:0;return this.substring(a,a+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,a){return(void 0===a||a>this.length)&&(a=this.length),this.substring(a-e.length,a)===e}),String.prototype.replaceAt||(String.prototype.replaceAt=function(e,a){var d=this.split("");return d[e]=a,d.join("")}),String.prototype.includes||(String.prototype.includes=function(e,a){return!((a="number"!=typeof a?0:a)+e.length>this.length)&&-1!==this.indexOf(e,a)}),String.prototype.capitalize||(String.prototype.capitalize=function(){return this.replace(/^./,function(e){return e.toUpperCase()})}),"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,a){a=a||{bubbles:!1,cancelable:!1,detail:null};var d=document.createEvent("CustomEvent");return d.initCustomEvent(e,a.bubbles,a.cancelable,a.detail),d}),IOL.adv={classname:"IOL.adv",version:"2.8.8",server:"//www.iolam.it",hostname:window.location.hostname,url:document.URL||"",referrer:document.referrer||!1,origin:window.location.origin,domain:"",browser:!1,device:!1,referrerLabel:!1,topics:[],hasFocus:window.document.hasFocus(),pageWidth:document.documentElement.clientWidth||window.innerWidth,liHistoryEligible:{},connectionType:navigator.connection?navigator.connection.effectiveType:"unknown",downlink:navigator.connection?navigator.connection.downlink:"99",validReadyState:["interactive","complete"],started:!1,complete:!1,mode:"standard",trackingMsg:"",displayEngine:{gpt:!0,staticBanner:!1},pubAdsCfg:{gdpr:!0,slot:"default",originalSlot:"default",section:"default",native:!1,inread:!1,customCriteria:!1,profile:!0,prebid:!0,lazy:!1,gptlazy:!1,deferredDisplay:!1,deferredRun:!1,forceHttps:!1,dynamicAds:{enable:!1},antiMalware:!1,ut:!1},gdpr:{enable:"function"==typeof __tcfapi,timer:!1,interval:250,maxIteration:20,timedOut:!1,consentString:!1,consentGoogle:!1,tcfv20:{tcData:!1,pipeline:{method:"standard",cmpApi:"iab"}}},profile:{enable:!1,up:{remoteHandler:"/service/up",cookie:{name:"up",duration:30},value:{trk:Math.floor(100*Math.random()+1),up:!1,ppid:{iol:!1,zeo:!1,fallback:!1,rtg:!1},age:!1,gender:!1,province:!1,ext:{seat_keyword:!1},isMinor:!1},comingFrom:"none",resource:{url:""}},as:{enable:!1,vendor:92,cookie:{name:"as",duration:30},value:{s:[],t:[],sda:{}},comingFrom:"none"}},deviceAccess:{enable:!1},syncId:{enable:!1,mode:"std",vendor:{criteo:{id:91,enable:!1,done:!1},liveramp:{id:97,enable:!1,done:!1},neustarPG:{id:468,enable:!1,done:!1},tncId:{id:750,enable:!1,done:!1},amazon:{id:793,enable:!1,done:!1}}},videoAds:{id:!1,reqCounter:0,status:"ready",mode:"get",adUnitPath:!1,adServerUrl:!1,trueview:{threshold:999999,param:!1},hb:{enable:!1,bidders:[],complete:!1,timedOut:!1},bob:{},timer:!1},test:{enable:!1,param:"dctestAdv",cookie:{name:"advTest",duration:1},value:!1,paramAdUnitVideo:"iu",paramAdUnitDisplay:"iud",adUnitVideo:!1,adUnitDisplay:!1,slot:"test"},timer:void 0!==window.performance&&void 0!==window.performance.now,debug:{log:{cookie:{name:"iamdbg",duration:90},enable:!1,id:!1},tracking:{enable:!1,randomInt:0,percentCustomerBase:1,time:{},adblock:!1,attr:[]}},start:function(){let d=IOL.adv.classname+".start";if(IOL.adv.tools.logger("start function",d),IOL.adv.domain=IOL.adv.tools.getDomain(window.location.host),IOL.adv.browser=IOL.adv.tools.getBrowser(),IOL.adv.device=IOL.adv.tools.getDevice(),IOL.adv.referrerLabel=IOL.adv.tools.getReferrerLabel(IOL.adv.referrer,"other"),IOL.adv.topics=IOL.adv.tools.getMetaTag("keywords",","),IOL.adv.pubAdsCfg.section=""==IOL.adv.pubAdsCfg.section?"default":IOL.adv.pubAdsCfg.section.toLowerCase(),IOL.adv.test.value=IOL.adv.tools.getParameterByName(IOL.adv.test.param)?IOL.adv.tools.getParameterByName(IOL.adv.test.param):IOL.adv.cookie.get(IOL.adv.test.cookie.name,!0),!1!==IOL.adv.test.value)switch(IOL.adv.test.value){case"0":case"off":IOL.adv.cookie.erase(IOL.adv.test.cookie.name),IOL.adv.tools.logger("Disable test on this properties with value: "+IOL.adv.test.value,d);break;default:IOL.adv.test.enable=!0,IOL.adv.cookie.set(IOL.adv.test.cookie.name,IOL.adv.test.value,IOL.adv.test.cookie.duration,"/",IOL.adv.domain,!0),IOL.adv.pubAdsCfg.slot=IOL.adv.test.slot+("default"!==IOL.adv.pubAdsCfg.slot?"_"+IOL.adv.pubAdsCfg.slot:""),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot]?(IOL.adv.test.adUnitVideo=!!IOL.adv.tools.getParameterByName(IOL.adv.test.paramAdUnitVideo)&&IOL.adv.tools.getParameterByName(IOL.adv.test.paramAdUnitVideo),IOL.adv.test.adUnitDisplay=!!IOL.adv.tools.getParameterByName(IOL.adv.test.paramAdUnitDisplay)&&IOL.adv.tools.getParameterByName(IOL.adv.test.paramAdUnitDisplay),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo&&IOL.adv.test.adUnitVideo&&IOL.adv.tools.logger("advideo :: Override adUnitPath: "+IOL.adv.test.adUnitVideo,d),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].video&&IOL.adv.test.adUnitVideo&&(IOL.adv.tools.logger("video :: Override adUnitPath: "+IOL.adv.test.adUnitVideo,d),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].video.adUnitPath=IOL.adv.test.adUnitVideo),IOL.adv.test.adUnitDisplay&&Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).filter(function(e){return"video"!==IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].mediaType}).forEach(function(e){IOL.adv.tools.logger(e+" :: Override adUnitPath: "+IOL.adv.test.adUnitDisplay,d),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].adUnitPath=IOL.adv.test.adUnitDisplay}),IOL.adv.tools.logger(`Enable test on this properties with value: ${IOL.adv.test.value}, adUnitVideo: ${IOL.adv.test.adUnitVideo}, adUnitDisplay: `+IOL.adv.test.adUnitDisplay,d)):(IOL.adv.test.enable=!1,IOL.adv.pubAdsCfg.slot=IOL.adv.pubAdsCfg.originalSlot,IOL.adv.tools.logger("Test slot does not exist, run with provided/default slot: "+IOL.adv.pubAdsCfg.slot,d,"warning"))}IOL.adv.pubAdsCfg.originalSlot=IOL.adv.pubAdsCfg.slot,IOL.adv.test.enable=IOL.adv.test.enable||IOL.adv.pubAdsCfg.slot==IOL.adv.test.slot,IOL.adv.test.enable&&(IOL.adv.test.value=IOL.adv.test.value||"1"),IOL.adv.tools.logger("Client  pubAdsCfg: "+JSON.stringify(window.pubAdsCfg),d),IOL.adv.tools.logger("Runtime pubAdsCfg: "+JSON.stringify(IOL.adv.pubAdsCfg),d),window.grumi={cfg:{advs:{},pubIds:{}},key:"4415fe16-b37d-46de-ac5c-69d63c72d5ee"},IOL.adv.settings.prebidjs=IOL.adv.settings.prebidjs||{},IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.adUnits||[],IOL.adv.headerBidding.supplyChainSid=IOL.adv.settings.supplyChainSid||IOL.adv.headerBidding.supplyChainSid,IOL.adv.tools.logger("Apply supplyChainSid: "+IOL.adv.headerBidding.supplyChainSid,d),IOL.adv.tools.asHandler("api"),IOL.adv.settings.hasOwnProperty("gdpr")&&(IOL.adv.pubAdsCfg.gdpr=IOL.adv.settings.gdpr),0==IOL.adv.pubAdsCfg.gdpr&&(IOL.adv.settings.tcfv20={enable:!1,tcData:!1,pipeline:{method:"demand",cmpApi:"iab",callback:function(){IOL.adv.tools.logger("run start without cmp",d),IOL.adv.tools.documentReady(function(){IOL.adv.run()})}}}),IOL.adv.settings.tcfv20&&(IOL.adv.tools.logger("Override tcfv20",d),IOL.adv.gdpr.tcfv20=IOL.adv.settings.tcfv20),IOL.adv.tools.trkPerf("iamCmpStart",Math.floor(performance.now()),["default"]),IOL.adv.tools.cmpHandler(d,function(){"demand"===IOL.adv.gdpr.tcfv20.pipeline.method?(IOL.adv.tools.logger("run in demand mode",d),IOL.adv.gdpr.tcfv20.pipeline.callback&&(IOL.adv.tools.trkPerf("iamCmpEnd",Math.floor(performance.now()),["default","demand"]),IOL.adv.tools.logger("run callback",d),IOL.adv.gdpr.tcfv20.pipeline.callback(),IOL.adv.tools.logger("end function",d))):(IOL.adv.tools.logger("run in standard mode",d),window.__tcfapi("addEventListener",2,function(e,a){a&&(IOL.adv.tools.logger("addEventListener eventStatus: "+e.eventStatus+", success: "+a,d),"tcloaded"!==e.eventStatus&&"useractioncomplete"!==e.eventStatus||"cmpuishown"===e.eventStatus||(IOL.adv.tools.trkPerf("iamCmpEnd",Math.floor(performance.now()),["default","success"]),IOL.adv.gdpr.tcfv20.tcData=e,IOL.adv.gdpr.consentString=IOL.adv.gdpr.tcfv20.tcData.tcString||!1,IOL.adv.tools.logger("addEventListener, tcData: "+JSON.stringify(IOL.adv.gdpr.tcfv20.tcData),d),window.__tcfapi("removeEventListener",2,function(e){IOL.adv.tools.logger("addEventListener removed success: "+e,d)},e.listenerId),IOL.adv.tools.documentReady(function(){IOL.adv.run()}),IOL.adv.tools.logger("end function",d)))}))},function(){IOL.adv.tools.logger("__tcfapi is missing, start advertising pipeline anyway",d),IOL.adv.tools.logger("end function",d),IOL.adv.tools.trkPerf("iamCmpEnd",Math.floor(performance.now()),["default","missing"]),IOL.adv.tools.documentReady(function(){IOL.adv.run()}),IOL.adv.tools.logger("end function",d)},IOL.adv.gdpr.timer,!0)},run:function(){var e=IOL.adv.classname+".run";IOL.adv.tools.logger("start function",e),IOL.adv.started?IOL.adv.tools.logger("advertising pipeline is already started",e):(IOL.adv.tools.logger("start advertising pipeline",e),IOL.adv.started=!0,IOL.adv.tools.trkPerf("iamStart",Math.floor(performance.now())),IOL.adv.gdpr.consentGoogle=IOL.adv.tools.getConsent([2,7,9,10],[755]),IOL.adv.tools.logger("consentGoogle is: "+IOL.adv.gdpr.consentGoogle,e),IOL.adv.deviceAccess.enable=IOL.adv.tools.getConsent([1],!1),IOL.adv.profile.enable=IOL.adv.tools.getConsent(IOL.adv.settings.purposeConsents||[1,3,4],IOL.adv.settings.vendorConsents||!1)&&IOL.adv.pubAdsCfg.profile,IOL.adv.profile.as.enable=IOL.adv.tools.getConsent([1,3,4,5,7,8,9],[IOL.adv.profile.as.vendor]),IOL.adv.syncId.enable=IOL.adv.tools.getConsent([1,2,3,4,5,6,7,8,9,10]),IOL.adv.syncId.enable&&Object.keys(IOL.adv.syncId.vendor).forEach(function(e){IOL.adv.syncId.vendor[e].enable=IOL.adv.tools.getConsent(!1,[IOL.adv.syncId.vendor[e].id])}),IOL.adv.setProfile(),IOL.adv.tools.syncIds(["tncId"]),IOL.adv.tools.utHandler(),IOL.adv.tools.logger("start loading 3rd party library depending on cmp",e),Object.keys(IOL.adv.settings.library).forEach(function(e){IOL.adv.settings.library[e].enable&&IOL.adv.settings.library[e].hasOwnProperty("gdpr")&&(IOL.adv.settings.library[e].enable=!1,"function"==typeof IOL.adv.settings.library[e].gdpr?IOL.adv.settings.library[e].enable=IOL.adv.settings.library[e].gdpr():IOL.adv.settings.library[e].enable=IOL.adv.tools.getConsent(!1,[IOL.adv.settings.library[e].gdpr]),IOL.adv.tools.inject(IOL.adv.settings.library[e]))}),IOL.adv.pubAdsCfg.dynamicAds.enable&&IOL.adv.pubAdsCfg.dynamicAds.id.forEach(function(e,a){IOL.adv.manager.createAds(e,a)}),IOL.adv.manager.init(function(){IOL.adv.manager.run()}))},setProfile:function(){var e=IOL.adv.classname+".setProfile";IOL.adv.tools.logger("Start function",e),IOL.adv.profile.up.cookie.name=IOL.adv.settings.userProfilingCookieName||IOL.adv.profile.up.cookie.name,IOL.adv.profile.enable?(IOL.adv.upHandler(),"function"==typeof IOL.adv.settings.ppid&&IOL.adv.settings.ppid()):IOL.adv.delProfile("light"),IOL.adv.tools.logger("end function",e)},upHandler:function(){let d=IOL.adv.classname+".upHandler";if(IOL.adv.tools.logger("Start function",d),!0===IOL.adv.settings.disableUpHandler)IOL.adv.tools.logger("upHandler disabled, disableUpHandler: "+IOL.adv.settings.disableUpHandler,d);else{var e={value:{trk:Math.floor(100*Math.random()+1),up:"",ppid:{iol:!1,zeo:!1,fallback:!1,rtg:!1},ts:"0"}},a=IOL.adv.cookie.get(IOL.adv.profile.up.cookie.name);if(a){try{e.value=JSON.parse(decodeURIComponent(a)),null==e.value.ext&&(e.value.ext={seat_keyword:!1})}catch(e){IOL.adv.tools.logger("Error parsing cookie "+IOL.adv.profile.up.cookie.name+", err: "+e.message,d)}IOL.adv.profile.up.value=Object.assign({},e.value),IOL.adv.tools.parseUp("cookie")}IOL.adv.profile.up.resource.url=IOL.adv.server+IOL.adv.profile.up.remoteHandler,IOL.adv.tools.logger("Handle the local user profile calling the remote host: "+IOL.adv.profile.up.resource.url,d),IOL.adv.tools.timer("",IOL.adv.profile.up.resource.url,"start"),IOL.adv.tools.remoteCall(IOL.adv.profile.up.resource.url,"d="+IOL.adv.domain+"&a=get&cn="+IOL.adv.profile.up.cookie.name+'&v={"ts":'+e.value.ts+"}",!0,function(e){try{IOL.adv.tools.logger("response from remote host: "+e,d);var a={cb:""};switch((a=JSON.parse(decodeURIComponent(e))).cb){case"set":IOL.adv.tools.logger("set data",d),IOL.adv.cookie.set(IOL.adv.profile.up.cookie.name,JSON.stringify(a.v),IOL.adv.profile.up.cookie.duration),IOL.adv.tools.logger("User profile has been written or refreshed on this properties with value:"+e,d),a.v.hasOwnProperty("ppid")&&(IOL.adv.profile.up.value.ppid=a.v.ppid),a.v.hasOwnProperty("ext")&&(IOL.adv.profile.up.value.ext=a.v.ext),a.v.hasOwnProperty("up")&&(IOL.adv.profile.up.value.up=a.v.up,IOL.adv.tools.parseUp("api")),IOL.adv.syncId.mode="upd";break;case"del":IOL.adv.tools.logger("delete data",d),IOL.adv.syncId.mode="del",IOL.adv.delProfile("light");break;default:IOL.adv.tools.logger("nothing to do",d)}IOL.adv.profile.up.duration=IOL.adv.tools.timer("",IOL.adv.profile.up.resource.url,"partial"),IOL.adv.tools.logger("User Profile final object value: "+JSON.stringify(IOL.adv.profile.up.value)+", comingFrom: "+IOL.adv.profile.up.comingFrom,d)}catch(e){IOL.adv.tools.logger("Something went wrong: "+e.message,d,"error")}}),IOL.adv.tools.logger("end function",d)}},delProfile:function(e){var a=IOL.adv.classname+".delProfile";IOL.adv.tools.logger("Start function",a),IOL.adv.cookie.get(IOL.adv.profile.up.cookie.name,!0)&&(IOL.adv.profile.up.value={trk:Math.floor(100*Math.random()+1),up:!1,ppid:!1,age:!1,gender:!1,province:!1,ext:{seat_keyword:!1}},IOL.adv.cookie.erase(IOL.adv.profile.up.cookie.name),IOL.adv.tools.logger("remove cookie "+IOL.adv.profile.up.cookie.name+" from domain:"+IOL.adv.domain,a)),"full"==e&&(IOL.adv.tools.logger("Start removing cookie also for www.iolam.it calling handler:"+IOL.adv.server+IOL.adv.profile.up.remoteHandler,a),IOL.adv.tools.remoteCall(IOL.adv.server+IOL.adv.profile.up.remoteHandler,"d="+IOL.adv.domain+"&a=del&cn="+IOL.adv.profile.up.cookie.name,!0),IOL.adv.tools.logger("End removing cookie also for www.iolam.it",a)),IOL.adv.tools.logger("end function",a)},getConsentString:function(){var e=IOL.adv.classname+".getConsentString";return IOL.adv.tools.logger("return consentString: "+IOL.adv.gdpr.consentString,e),IOL.adv.gdpr.consentString},isUserProfileEnable:function(){var e=IOL.adv.classname+".isUserProfileEnable";return IOL.adv.tools.logger("return isUserProfileEnable: "+IOL.adv.profile.enable,e),IOL.adv.profile.enable},getProfile:function(e){var a=IOL.adv.classname+".getProfile",d={};switch(e=e||"all"){case"ppid":d.ppid=IOL.adv.profile.up.value.ppid||!1;break;case"ppid.iol":d=IOL.adv.profile.up.value.ppid&&IOL.adv.profile.up.value.ppid.iol||!1;break;case"ppid.gm":d=IOL.adv.profile.up.value.ppid&&IOL.adv.profile.up.value.ppid.gm||!1;break;case"ppid.rem":d=IOL.adv.profile.up.value.ppid&&IOL.adv.profile.up.value.ppid.rem||!1;break;case"ppid.zeo":d=IOL.adv.profile.up.value.ppid&&IOL.adv.profile.up.value.ppid.zeo||!1;break;case"ppid.fallback":d=IOL.adv.profile.up.value.ppid&&IOL.adv.profile.up.value.ppid.fallback||!1;break;case"ppid.rtg":d=IOL.adv.profile.up.value.ppid&&IOL.adv.profile.up.value.ppid.rtg||!1;break;case"age":d.age=IOL.adv.profile.up.value.age||"0";break;case"gender":d.gender=IOL.adv.profile.up.value.gender||"0";break;case"province":d.province=IOL.adv.profile.up.value.province||"0";break;case"consentData":var t=IOL.adv.getConsentString();d.consentData=""!==t&&t;break;case"audience":d.audience=!1!==IOL.adv.profile.as.value&&IOL.adv.profile.as.value;break;default:d.age=IOL.adv.profile.up.value.age||"0",d.gender=IOL.adv.profile.up.value.gender||"0",d.province=IOL.adv.profile.up.value.province||"0";t=IOL.adv.getConsentString();d.consentData=""!==t&&t,d.audience=IOL.adv.profile.as.value||!1}return IOL.adv.tools.logger("w: "+e+", r: "+JSON.stringify(d),a),d},hasConsent:function(){var e=IOL.adv.classname+".hasConsent",a=!1;return IOL.adv.gdpr.enable&&(a=!!IOL.adv.gdpr.consentString),IOL.adv.tools.logger("hasConsent: "+a,e),a},refreshSlot:function(e,a=!1,d="display"){let t=IOL.adv.classname+".refreshSlot",o=setInterval(function(){IOL.adv.complete?(IOL.adv.tools.logger(d+" :: refreshSlot requested, pipeline completed run refreshSlotRun",t),clearInterval(o),IOL.adv.refreshSlotRun(e,a,d)):IOL.adv.tools.logger(d+" :: refreshSlot requested, pipeline not completed please wait...",t)},250)},refreshSlotRun:function(d,e,t){let o=IOL.adv.classname+".refreshSlotRun";IOL.adv.tools.logger("Start function",o),IOL.adv.complete=!1,"display"==t&&(IOL.adv.mode="refresh"),IOL.adv.pubAdsCfg.deferredDisplay&&(IOL.adv.pubAdsCfg.deferredDisplay=!1),IOL.adv.manager.refreshSlotsContainer={requested:[],valid:[],slots:[],ads:{}},d?(IOL.adv.manager.refreshSlotsContainer.requested=d.split(",").filter(function(e){if(e)return e}),IOL.adv.manager.refreshSlotsContainer.requested=IOL.adv.manager.refreshSlotsContainer.requested.map(e=>e.trim())):Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(e){IOL.adv.manager.refreshSlotsContainer.requested.push(e)}),IOL.adv.manager.refreshSlotsContainer.valid=IOL.adv.manager.refreshSlotsContainer.requested.filter(function(e){if(!IOL.adv.manager.slotsContainer[e])return IOL.adv.tools.logger("Refresh disable, "+e+" is not in slotsContainer.",o),!1;var a=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e];let d=!0;return a.refresh?Date.now()-a.refresh.ts>a.refresh.gap?a.refresh.ts=Date.now():(d=!1,IOL.adv.tools.logger("Refresh disable, "+e+" refresh gap is not reached yet",o)):(d=!1,IOL.adv.tools.logger("Refresh disable, "+e+" this ads is not compliant for refresh.",o)),a.mediaType==t&&d}),"video"==t&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo&&IOL.adv.manager.refreshSlotsContainer.valid.push("advideo"),IOL.adv.tools.logger("Requested slots: "+IOL.adv.manager.refreshSlotsContainer.requested.toString()+". Valid slots to refresh: "+IOL.adv.manager.refreshSlotsContainer.valid.toString(),o),0==IOL.adv.manager.refreshSlotsContainer.valid.length?(IOL.adv.complete=!0,IOL.adv.tools.logger("Refresh disable no ads to refresh.",o)):(IOL.adv.manager.refreshSlotsContainer.valid.forEach(function(e){let d=IOL.adv.manager.slotsContainer[e];d&&(IOL.adv.tools.setTargeting(d,{adv_arc:null}),Object.getOwnPropertyNames(d.getConfig("targeting").targeting||{}).forEach(e=>{var a;e.startsWith("iat-")&&((a={})[e]=null,IOL.adv.tools.setTargeting(d,a))}),IOL.adv.manager.refreshSlotsContainer.slots.push(d))}),Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(e){var a=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e];if(0<=IOL.adv.manager.refreshSlotsContainer.valid.indexOf(e)&&("function"==typeof(IOL.adv.manager.refreshSlotsContainer.ads[e]=a).fnBeforeRefresh&&(IOL.adv.tools.logger(e+" fnBeforeRefresh: run function before refresh.",o),a.fnBeforeRefresh()),a.onRenderEnded))try{a.onRenderEnded.forEach(function(e){IOL.adv.tools.logger(a.divId+" :: found onRenderEnded",o),e.condition=e.condition||"default","function"!=typeof e.allowedSizes&&(e.allowedSizes=e.allowedSizes?Array.isArray(e.allowedSizes)?e.allowedSizes:Array(e.allowedSizes):[]),IOL.adv.tools.onRenderEnded(a,e)})}catch(e){}}),void 0!==IOL.adv.settings.prebidjs&&Object.keys(IOL.adv.manager.refreshSlotsContainer.ads).forEach(function(e){var a=IOL.adv.manager.refreshSlotsContainer.ads[e];if(a.staticBanner){IOL.adv.tools.logger(a.divId+": staticBanner found",o);let e=!(IOL.adv.gdpr.consentGoogle||IOL.adv.pubAdsCfg.deferredDisplay||"asFirst"!=a.staticBanner.mode&&IOL.adv.headerBidding.enable);IOL.adv.tools.displayStaticBanner(a,"asFirst",function(){return"function"==typeof a.staticBanner.condition?a.staticBanner.condition(a,e):e},function(){IOL.adv.tools.logger(d+": disable hb, use staticBanner for this ads",o),a.bidAmazon=!1,IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.rmAdunitByCode,{code:a.divId})},o)}}),IOL.adv.tools.logger("Start headerBidding.init",o),IOL.adv.headerBidding.init(IOL.adv.manager.refreshSlotsContainer.ads,function(){IOL.adv.headerBidding.enable?IOL.adv.headerBidding.run(e):googletag.cmd.push(()=>{if(0<IOL.adv.manager.refreshSlotsContainer.slots.length){IOL.adv.tools.logger("Refresh slots using standard mode",o),IOL.adv.tools.displayAds({slotContainer:IOL.adv.manager.refreshSlotsContainer.slots});try{"function"==typeof IamCallbackOnComplete&&(IOL.adv.tools.logger("Hook IamCallbackOnComplete. HeaderBidding is disable",o),IamCallbackOnComplete())}catch(e){}}})}),IOL.adv.tools.logger("End function.",o))},reloadAd:function(a=!1,d=!1){let t=IOL.adv.classname+".reloadAd";try{if(!a)throw{msg:"ad not provided",lvl:"warning"};let e=setInterval(function(){IOL.adv.complete?(IOL.adv.tools.logger("reloadAd requested, pipeline completed run reloadAdRun",t),clearInterval(e),IOL.adv.reloadAdRun(a,d)):IOL.adv.tools.logger("reloadAd requested, pipeline not completed please wait...",t)},250)}catch(e){IOL.adv.tools.logger(e.msg,t,e.lvl)}},reloadAdRun:function(o,e){let i=IOL.adv.classname+".reloadAdRun";try{if(IOL.adv.tools.logger("Start function",i),IOL.adv.complete=!1,IOL.adv.pubAdsCfg.deferredRun=!1,IOL.adv.mode="reloadAd",!o||!IOL.adv.manager.slotsContainer[o.id])throw{msg:`ads ${id} not found`,lvl:"error"};IOL.adv.pubAdsCfg.slot=IOL.adv.test.enable?"test_reloadAd":"reloadAd",e&&(o={...o,...e},IOL.adv.tools.logger(`${o.id} :: Override attribute: ${JSON.stringify(e)}, ad: `+JSON.stringify(o),i)),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot]={initAdsDone:!0,ads:{}},IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[o.id]=o,IOL.adv.destroySlot(o.id),IOL.adv.manager.originalSlotsContainer=Object.assign({},IOL.adv.manager.slotsContainer),IOL.adv.manager.slotsContainer=[],IOL.adv.headerBidding.overridePrebidSize(o.id,o.size[0]),IOL.adv.tools.logger("Run advertising pipeline for ad "+o.id,i),IOL.adv.manager.init(function(){IOL.adv.manager.run()});let a=e=>{e.slot.getSlotElementId()===o.divId&&(IOL.adv.tools.logger(`slotRequested for ${o.id} triggered, remove event listener`,i),googletag.pubads().removeEventListener("slotRequested",a),o.refresh.ts=Date.now(),IOL.adv.manager.slotsContainer=IOL.adv.tools.extend(IOL.adv.manager.slotsContainer,IOL.adv.manager.originalSlotsContainer),IOL.adv.tools.logger(`Revert slot ${IOL.adv.pubAdsCfg.slot} with ${IOL.adv.pubAdsCfg.originalSlot}, delete slot ${IOL.adv.pubAdsCfg.slot} object`,i),delete IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot],IOL.adv.pubAdsCfg.slot=IOL.adv.pubAdsCfg.originalSlot,IOL.adv.complete=!0)},t=(googletag.pubads().addEventListener("slotRequested",a),e=>{var a,d;e.slot.getSlotElementId()===o.divId&&(IOL.adv.tools.trkPerf("iamReloadAd",Math.floor(performance.now()),[o.id,"hit_"+o.refresh.counter,"isEmpty"+(e.isEmpty?"True":"False")],!0),IOL.adv.tools.logger(`slotRenderEnded for ${o.id} triggered, remove event listener`,i),googletag.pubads().removeEventListener("slotRenderEnded",t),e.isEmpty?(IOL.adv.tools.logger(o.id+" :: ads is empty, staticBannerIfEmpty: "+o.refresh.staticBannerIfEmpty,i),o.refresh.staticBannerIfEmpty&&(e=document.getElementById(o.divId))&&(IOL.adv.tools.logger(`${o.id} :: inject static banner with size ${o.size[0][0]}x`+o.size[0][1],i),e.replaceChildren(),(a=document.createElement("iframe")).setAttribute("src",`//i.plug.it/banners/html/ut.html?ns=${IOL.adv.settings.ns}&w=${o.size[0][0]}&h=`+o.size[0][1]),a.setAttribute("width",o.size[0][0]),a.setAttribute("height",o.size[0][1]),a.setAttribute("scrolling","no"),a.setAttribute("style","border: 0px;"),a.setAttribute("marginWidth","0"),a.setAttribute("marginheigth","0"),a.onload=function(){IOL.adv.tools.logger(o.id+" :: static banner loaded",i)},d={emitter:"static",adUnitCode:o.divId,mediaType:"banner",width:o.size[0][0],height:o.size[0][1]},IOL.adv.tools.logger(o.id+" :: emit event iamRenderEnded, detail: "+JSON.stringify(d),i),d=new CustomEvent("iamRenderEnded",{detail:d}),document.dispatchEvent(d),e.appendChild(a),e.display="block")):IOL.adv.tools.logger(o.divId+" :: reloaded ads is not empty",i))});googletag.pubads().addEventListener("slotRenderEnded",t),IOL.adv.tools.logger("End function",i)}catch(e){IOL.adv.tools.logger(e.msg,i,e.lvl)}},createAds:function(s,e){let r=IOL.adv.classname+".createAds";IOL.adv.mode="createads",IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic?IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic[s]?("string"==typeof e?Array(e):e).forEach(function(t){var o,i,n=s+"_"+t;IOL.adv.manager.slotsContainer[n]?(IOL.adv.tools.logger(n+" has been already created, so refresh it",r),IOL.adv.settings.prebidjs.onDemandAdUnits&&IOL.adv.settings.prebidjs.onDemandAdUnits[s]&&(IOL.adv.tools.logger("prebid dynamic code: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].divId,r),IOL.adv.settings.prebidjs.onDemandAdUnits[s].code=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].divId,IOL.adv.settings.prebidjs.adUnits.push(IOL.adv.settings.prebidjs.onDemandAdUnits[s])),IOL.adv.refreshSlot(n)):(o=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic[s],i=setInterval(function(){if(IOL.adv.complete){IOL.adv.tools.logger("advertising pipeline complete: "+IOL.adv.complete,r),clearInterval(i),IOL.adv.complete=!1;var e="on-demand-ads";IOL.adv.test.enable&&(e="test_".concat(e)),IOL.adv.pubAdsCfg.slot=e,IOL.adv.tools.logger("Apply new slot: "+IOL.adv.pubAdsCfg.slot,r),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot]={},IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot]={ads:{}},IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n]={},IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].id=n,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].mediaType="display",IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].divIdReady=!0,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].divId=t,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].adUnitPath=o.adUnitPath,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].size=o.size||!1,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].sizeMapping=o.sizeMapping||!1,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].refresh=o.refresh,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].onRenderEnded=o.onRenderEnded,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].bidAmazon=o.bidAmazon,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].optional=o.optional,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].setCollapseEmptyDiv=o.setCollapseEmptyDiv,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].forceSafeFrame=o.forceSafeFrame||!1,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].outOfPage=o.outOfPage||!1,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].interstitial=o.interstitial||!1,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].fnBefore=o.fnBefore,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].fnAfter=o.fnAfter,IOL.adv.tools.logger("Create ads on demand with id: "+n+", divId: "+t,r),IOL.adv.manager.originalSlotsContainer=Object.assign({},IOL.adv.manager.slotsContainer),IOL.adv.manager.slotsContainer=[],IOL.adv.tools.logger("originalSlotsContainer: "+IOL.adv.manager.originalSlotsContainer,r),IOL.adv.settings.prebidjs.adUnits&&(IOL.adv.settings.prebidjs.originalAdUnits=IOL.adv.settings.prebidjs.adUnits,IOL.adv.settings.prebidjs.adUnits=[]),IOL.adv.settings.prebidjs.onDemandAdUnits&&IOL.adv.settings.prebidjs.onDemandAdUnits[s]&&(IOL.adv.tools.logger("prebid dynamic code: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].divId,r),IOL.adv.settings.prebidjs.onDemandAdUnits[s].code=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n].divId,IOL.adv.settings.prebidjs.adUnits.push(IOL.adv.settings.prebidjs.onDemandAdUnits[s])),IOL.adv.manager.init(function(){IOL.adv.manager.run()});let a=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n],d=e=>{IOL.adv.tools.logger(`slotRequested for ${n} triggered, getSlotElementId: ${e.slot.getSlotElementId()}, outOfPage: ${a.outOfPage}, interstitial: `+a.interstitial,r),e.slot.getSlotElementId()===IOL.adv.manager.slotsContainer[n].getSlotElementId()&&(googletag.pubads().removeEventListener("slotRequested",d),IOL.adv.tools.logger("Revert slot and prebid config, extend IOL.adv.manager.slotsContainer with on demand slot",r),IOL.adv.pubAdsCfg.slot=IOL.adv.pubAdsCfg.originalSlot,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n]||(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[n]=a),IOL.adv.settings.prebidjs.originalAdUnits&&(IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.originalAdUnits),IOL.adv.manager.slotsContainer=IOL.adv.tools.extend(IOL.adv.manager.slotsContainer,IOL.adv.manager.originalSlotsContainer))};googletag.pubads().addEventListener("slotRequested",d)}else IOL.adv.tools.logger("advertising pipeline not completed...",r)},250))}):IOL.adv.tools.logger(s+" is not a defined ads dynamic slot",r):IOL.adv.tools.logger("dynamic slot is non configured for namespace: "+IOL.adv.settings.ns,r)},displaySlot:function(e,a){let d=IOL.adv.classname+".displaySlot";var t={requested:[],slots:[]};IOL.adv.pubAdsCfg.deferredDisplay&&(IOL.adv.pubAdsCfg.deferredDisplay=!1),e?t.requested=e.split(",").filter(function(e){if(e)return e}):Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(e){t.requested.push(e)}),IOL.adv.tools.logger("Requested slots : "+t.requested.toString(),d),t.requested.forEach(function(e){IOL.adv.manager.slotsContainer[e]?(t.slots.push(IOL.adv.manager.slotsContainer[e]),IOL.adv.tools.logger(e+" is a valid slot",d)):IOL.adv.tools.logger(e+" is not a valid slot",d)}),IOL.adv.headerBidding.enable?IOL.adv.tools.displayAds({slotContainer:t.slots}):IOL.adv.tools.displayAds({slotId:IOL.adv.manager.lastSlotIdReady}),a&&(IOL.adv.tools.logger("Run callback "+a,d),a())},destroySlot:function(e){let a=IOL.adv.classname+".destroySlot";IOL.adv.tools.logger("Start function",a),e?e.split(",").forEach(function(e){IOL.adv.manager.slotsContainer[e]?googletag.cmd.push(()=>{IOL.adv.tools.logger("start destroySlot for slot: "+e,a),googletag.destroySlots([IOL.adv.manager.slotsContainer[e]]),delete IOL.adv.manager.slotsContainer[e]}):IOL.adv.tools.logger("slot "+e+" does not exist",a)}):googletag.cmd.push(()=>{IOL.adv.tools.logger("destroySlot: all slots",a),googletag.destroySlots()}),IOL.adv.tools.logger("End function",a)},clearSlot:function(e){let a=IOL.adv.classname+".clearSlot";IOL.adv.tools.logger("Start function",a),IOL.adv.tools.logger("clearSlot request: "+e,a),e?e.split(",").forEach(function(e){IOL.adv.manager.slotsContainer[e]?googletag.cmd.push(()=>{IOL.adv.tools.logger("start clear for slot: "+e,a),googletag.pubads().clear([IOL.adv.manager.slotsContainer[e]])}):IOL.adv.tools.logger("slot "+e+" does not exist",a)}):googletag.cmd.push(()=>{IOL.adv.tools.logger("destroySlot for all slots",a),googletag.pubads().clear()}),IOL.adv.tools.logger("End function",a)},getAdUnitPath:function(e,a,d){var d=IOL.adv.classname+".getAdUnitPath,"+d,t=!1;a=a?a.toLowerCase():"";try{e&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e]&&(t=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].adUnitPathOverride&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].adUnitPathOverride[a]?IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].adUnitPathOverride[a]:IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].adUnitPath,IOL.adv.pubAdsCfg.section&&IOL.adv.settings.sectionMap&&(t=IOL.adv.settings.sectionMap[IOL.adv.pubAdsCfg.section]?t.replace("%SECTION%",IOL.adv.settings.sectionMap[IOL.adv.pubAdsCfg.section]):t.replace("%SECTION%",IOL.adv.settings.sectionMap.default)),void 0===window._ABTestingTrack||/test[A|B|C]$/.test(t)||(t+="/test"+window._ABTestingTrack.toUpperCase()),6<(t=IOL.adv.test.enable?t.replace("%PLACEHOLDER%",IOL.adv.test.value):t).split("/").filter(e=>e).length)&&IOL.adv.tools.logger(`adUnitPath level for ad ${e}: ${t} is greater than accepted`,d,"warning")}catch(e){}return IOL.adv.tools.logger("adUnitPath for ad: "+e+", provider: "+a+" is: "+t,d),t},setAdUnitPath:function(e,a){var d=IOL.adv.classname+".setAdUnitPath";try{e&&a&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e]&&(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].adUnitPath=a)}catch(e){return!1}return IOL.adv.tools.logger("adUnitPath for ad: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].adUnitPath,d),!0},setAdUnitContent:function(e,a){var d=IOL.adv.classname+".setAdUnitContent";IOL.adv.tools.logger("set content for "+e+": "+a,d);try{if(e&&a)return IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e]?(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].content=a,!0):IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].content=!1}catch(e){return!1}},setAdSliderContent:function(e){var a=IOL.adv.classname+".setAdSliderContent";IOL.adv.tools.logger("try to set adslider content: "+JSON.stringify(e),a);try{if(e&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer)return e.adunit=e.adunit.split("/").pop(),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.content.push(e),IOL.adv.tools.logger("adslider content set",a),!0}catch(e){return!1}},setUrl:function(e){var a=IOL.adv.classname+".setUrl";IOL.adv.url=e,IOL.adv.tools.logger("IOL.adv.url: "+IOL.adv.url,a)},setVideoAdsTrueViewThreshold:function(e){var a=IOL.adv.classname+".setVideoAdsTrueViewThreshold";e&&(IOL.adv.videoAds.trueview.threshold=e),IOL.adv.tools.logger("trueview.threshold: "+IOL.adv.videoAds.trueview.threshold,a)},getAdUnitContent:function(e){var a=IOL.adv.classname+".getAdUnitContent",d=!1;try{e&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].content&&(d=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].content)}catch(e){}return IOL.adv.tools.logger("get content for "+e+": "+d,a),d},getVideoAds:function(d,t,o){let i=IOL.adv.classname+".getVideoAds";IOL.adv.tools.trkVideo({evnt:"iam_getvideoads_request",reload:IOL.adv.videoAds.bob.reload||0,count:IOL.adv.videoAds.reqCounter+1,time:Math.floor(performance.now())}),0!=IOL.adv.videoAds.reqCounter||IOL.adv.gdpr.consentString||!1===IOL.adv.pubAdsCfg.gdpr?(IOL.adv.tools.logger("runGetVideoAds start",i),IOL.adv.runGetVideoAds(d,t,o)):(IOL.adv.tools.trkPerf("iamCmpStart",Math.floor(performance.now()),["video"]),IOL.adv.tools.cmpHandler(i,function(){"demand"===IOL.adv.gdpr.tcfv20.pipeline.method?(IOL.adv.tools.logger("run in demand mode",i),IOL.adv.gdpr.tcfv20.pipeline.callback&&(IOL.adv.tools.trkPerf("iamCmpEnd",Math.floor(performance.now()),["video","demand"]),IOL.adv.tools.logger("run callback",i),IOL.adv.gdpr.tcfv20.pipeline.callback(),IOL.adv.tools.logger("end function",i))):(IOL.adv.tools.logger("run in standard mode",i),window.__tcfapi("addEventListener",2,function(e,a){a?(IOL.adv.tools.logger("addEventListener eventStatus: "+e.eventStatus+", success: "+a,i),"tcloaded"!==e.eventStatus&&"useractioncomplete"!==e.eventStatus||"cmpuishown"===e.eventStatus||(IOL.adv.tools.trkPerf("iamCmpEnd",Math.floor(performance.now()),["video","success"]),IOL.adv.gdpr.tcfv20.tcData=e,IOL.adv.gdpr.consentString=IOL.adv.gdpr.tcfv20.tcData.tcString||!1,IOL.adv.tools.logger("addEventListener tcData: "+JSON.stringify(IOL.adv.gdpr.tcfv20.tcData),i),IOL.adv.tools.logger("addEventListener, start advertising pipeline",i),window.__tcfapi("removeEventListener",2,function(e){IOL.adv.tools.logger("addEventListener removed success: "+e,i)},e.listenerId),IOL.adv.runGetVideoAds(d,t,o),IOL.adv.tools.logger("end function",i))):(IOL.adv.tools.logger("addEventListener failed, start video advertising pipeline anyway",i),IOL.adv.tools.trkPerf("iamCmpEnd",Math.floor(performance.now()),["video","fail"]),IOL.adv.runGetVideoAds(d,t,o),IOL.adv.tools.logger("end function",i))}))},function(){IOL.adv.tools.logger("__tcfapi is missing, start advertising pipeline anyway",i),IOL.adv.tools.logger("end function",i),IOL.adv.tools.trkPerf("iamCmpEnd",Math.floor(performance.now()),["video","missing"]),IOL.adv.runGetVideoAds(d,t,o)},IOL.adv.videoAds.timer,!0))},runGetVideoAds:function(e,a,d){let t=IOL.adv.classname+".runGetVideoAds";var o="advideo",e=e||"",d=d||!1;if(IOL.adv.videoAds.reqCounter++,!IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo)return IOL.adv.tools.logger("advideo slot is not defined",t,"error"),IOL.adv.videoAds.status="error",IOL.adv.videoAds.msg="slot advideo not defined",IOL.adv.tools.trkVideo({evnt:"iam_getvideoads_error",reload:IOL.adv.videoAds.bob.reload||0,count:IOL.adv.videoAds.reqCounter,time:Math.floor(performance.now())}),a?(IOL.adv.tools.logger("Requested callback "+a,t),void a(IOL.adv.videoAds)):IOL.adv.videoAds;var i,n,s,r,l=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo;l.maxRequest&&IOL.adv.videoAds.reqCounter>l.maxRequest.value&&l.maxRequest.callback?(IOL.adv.tools.logger("max requests exceeded, run: "+l.maxRequest.callback,t),l.maxRequest.callback()):(1===IOL.adv.videoAds.reqCounter?(IOL.adv.videoAds.mode="standard",IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.divIdReady||(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.divIdReady=!0),IOL.adv.headerBidding.supplyChainSid=IOL.adv.settings.supplyChainSid||!1,IOL.adv.tools.logger("Apply schainSid: "+IOL.adv.headerBidding.supplyChainSid,t),"function"!=typeof IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit||IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInitDone||(IOL.adv.tools.logger(`Run fnInit on slot: ${IOL.adv.pubAdsCfg.slot} using function: `+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit,t),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInitDone=!0,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit()),"function"!=typeof l.fnBefore||l.fnBeforeDone||(IOL.adv.tools.logger("Start fnBefore for "+o,t),l.fnBeforeDone=!0,l.fnBefore(o,l))):(IOL.adv.videoAds.mode="refresh",IOL.adv.refreshSlot(o,!1,"video")),IOL.adv.videoAds.adUnitPath=IOL.adv.getAdUnitPath("advideo",e,t),l.appendCounterOnAdUnitPath&&(IOL.adv.videoAds.adUnitPath+="/pod"+IOL.adv.videoAds.reqCounter),IOL.adv.tools.logger("Requested provider: "+e+", adUnitPath: "+IOL.adv.videoAds.adUnitPath,t),s=!(n=!(i=0)),r=setInterval(function(){25<=i||!IOL.adv.headerBidding.enable||IOL.adv.headerBidding.requestManager.adServerRequestSent?(IOL.adv.tools.logger("HeaderBidding "+(IOL.adv.headerBidding.enable?"done":"disable"),t),s&&IOL.adv.tools.trkVideo({evnt:"iam_getvideoads_waiting_end",reload:IOL.adv.videoAds.bob.reload||0,count:IOL.adv.videoAds.reqCounter,time:Math.floor(performance.now())}),clearInterval(r),IOL.adv.complete=!0,IOL.adv.createVideoAds(e,a,d,l),"function"!=typeof l.fnAfter||l.fnAfterDone||(IOL.adv.tools.logger("Start fnAfter for "+o,t),l.fnAfterDone=!0,l.fnAfter(o,l))):(s=!0,n&&(IOL.adv.tools.trkVideo({evnt:"iam_getvideoads_waiting_start",reload:IOL.adv.videoAds.bob.reload||0,count:IOL.adv.videoAds.reqCounter,time:Math.floor(performance.now())}),n=!1),IOL.adv.tools.logger("HeaderBidding is still running...",t),i++)},250))},createVideoAds:function(e,a,d,t){var o=IOL.adv.classname+".createVideoAds",i=(IOL.adv.videoAds.id=IOL.adv.tools.randomId(),IOL.adv.videoAds.status="ready",IOL.adv.videoAds.adServerUrl=!1,IOL.adv.videoAds.videoProvider=e||"",IOL.adv.videoAds.hb={enable:!1,bidders:[],complete:!1,timedOut:!1},""),e=("function"==typeof IOL.adv.settings.overrideProvider&&(overrideProvider=IOL.adv.settings.overrideProvider())&&(e=overrideProvider,IOL.adv.tools.logger("Provider overrided with: "+overrideProvider,o)),IOL.adv.getProfile(),d&&(t.optionalFunction&&(t.optionalFunction.function?t.optionalFunction.function.f&&(IOL.adv.tools.logger("Run optional function: "+t.optionalFunction.function.f,o),t.optionalFunction.function.f(t,d)):IOL.adv.tools.logger("Optional function not defined",o)),d.clientCustomParams)&&(IOL.adv.tools.logger("Apply clientCustomParams placeholder",o),i="__CLIENTCUSTOMPARAMS__&"),!!IOL.adv.profile.enable&&(IOL.adv.pubAdsCfg.ppid||(IOL.adv.getProfile("ppid.iol")?IOL.adv.getProfile("ppid.iol"):!!IOL.adv.getProfile("ppid.fallback")&&IOL.adv.getProfile("ppid.fallback")))),d=(IOL.adv.tools.logger("setPublisherProvidedId using ppid: "+e,o),IOL.adv.videoAds.adServerUrl="https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&ciu_szs=&unviewed_position_start=1&gdfp_req=1&impl=s&env=vp&output=vast&iu="+encodeURIComponent(IOL.adv.videoAds.adUnitPath)+"&url=[referrer_url]&correlator=[timestamp]&description_url="+encodeURIComponent(IOL.adv.url)+"&npa="+(IOL.adv.profile.enable?"0":"1")+"&tfcd="+(IOL.adv.profile.up.value.isMinor?"1":"0")+(e?"&ppid="+e:"")+"&cust_params="+encodeURIComponent(i)+IOL.adv.tools.getCustomParams()+IOL.adv.headerBidding.getAmazonVideoBid(),t.adServerUrlAppendParams&&(IOL.adv.videoAds.adServerUrl+=t.adServerUrlAppendParams),IOL.adv.headerBidding.prebidjs.enable&&IOL.adv.settings.prebidjs.adUnits.find(IOL.adv.headerBidding.findAdunitByMediaType,{mediaType:"video"})||!1);/&plcmt=/.test(IOL.adv.videoAds.adServerUrl)||(e=d&&d.mediaTypes.video.hasOwnProperty("plcmt")?d.mediaTypes.video.plcmt:IOL.adv.pubAdsCfg.customCriteria.adv_playertv||IOL.adv.pubAdsCfg.customCriteria.adv_playerincontent?2:1,IOL.adv.tools.logger("add plcmt on adServerUrl: "+e,o),IOL.adv.videoAds.adServerUrl+="&plcmt="+e),IOL.adv.headerBidding.prebidjs.enable&&d&&(IOL.adv.tools.logger("Add pbjs bids on video adServerUrl",o),IOL.adv.videoAds.adServerUrl=pbjs.adServers.dfp.buildVideoUrl({adUnit:d,url:IOL.adv.videoAds.adServerUrl,output:"vast"}),IOL.adv.tools.logger("Final pbjs video url: "+IOL.adv.videoAds.adServerUrl,o)),IOL.adv.videoAds.hb.enable=IOL.adv.headerBidding.enable,IOL.adv.videoAds.hb.bidders=IOL.adv.headerBidding.enable?IOL.adv.headerBidding.bidders.filter(e=>"gpt"!==e):[],IOL.adv.videoAds.hb.complete=IOL.adv.headerBidding.requestManager.adServerRequestSent||!IOL.adv.headerBidding.enable,IOL.adv.videoAds.hb.timedOut=IOL.adv.headerBidding.requestManager.timedOut,IOL.adv.videoAds.status="complete",IOL.adv.tools.logger("Video Ads: "+JSON.stringify(IOL.adv.videoAds),o),IOL.adv.tools.trkVideo({evnt:"iam_getvideoads_response",reload:IOL.adv.videoAds.bob.reload||0,count:IOL.adv.videoAds.reqCounter,time:Math.floor(performance.now())}),a&&(IOL.adv.tools.logger("Requested callback "+a,o),a(IOL.adv.videoAds)),"function"==typeof IamCallbackVideoAdsOnComplete&&(IOL.adv.tools.logger("Hook IamCallbackVideoAdsOnComplete",o),IamCallbackVideoAdsOnComplete())},getVideoAdServerUrl:function(){return IOL.adv.videoAds.adServerUrl},reload:function(){let d=IOL.adv.classname+".reload";IOL.adv.tools.logger("Reload requested",d);try{var e;"function"==typeof IOL.adv.settings.fnBeforeReload&&(IOL.adv.tools.logger("fnBeforeReload: run function before reload.",d),IOL.adv.settings.fnBeforeReload()),"function"==typeof AdvSknRmv&&(IOL.adv.tools.logger("remove skin calling AdvSknRmv",d),AdvSknRmv()),IOL.adv.destroySlot(),IOL.adv.manager.slotsContainer=[],IOL.adv.manager.refreshSlotsContainer=[],IOL.adv.manager.originalSlotsContainer=[],IOL.adv.manager.lastSlotIdReady="",IOL.adv.manager.videoAds=!1,IOL.adv.manager.customCriteria={map:{},set:[],duration:""},IOL.adv.pubAdsCfg.lazy&&Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(e){var a,e=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e];"display"==e.mediaType&&e.lazy&&(IOL.adv.tools.logger("try to unobserve lazy ad: "+e.divId,d),a=IOL.adv.tools.divIdReady(e,!0))&&(IOL.adv.tools.logger("unobserve lazy ad: "+e.divId,d),IOL.adv.settings.lazy.observer.obj.unobserve(a))}),IOL.adv.pubAdsCfg.customCriteria&&IOL.adv.pubAdsCfg.customCriteria.adv_playertv&&(e=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.adoutofpage||!1)&&(IOL.adv.tools.logger("Try to remove prebid config and set mediaType disable for adoutofpage",d),e.mediaType="disabledAvoidRefresh",IOL.adv.settings.hasOwnProperty("prebidjs"))&&IOL.adv.settings.prebidjs.hasOwnProperty("adUnits")&&(IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.rmAdunitByCode,{code:e.divId})),IOL.adv.tools.logger("Reload advertising",d),IOL.adv.manager.init(function(){IOL.adv.manager.run()})}catch(e){IOL.adv.tools.logger("something went wrong: "+e,d,"error")}}},IOL.adv.tools={classname:"IOL.adv.tools",timerContainer:[],logger:function(e,a,d){if(IOL.adv.debug.log.enable){var t="IAM::"+IOL.adv.version+(IOL.adv.settings.ns?"::"+IOL.adv.settings.ns:"")+"::"+IOL.adv.debug.log.id,d=d||"info",o=new Date,i=o.getUTCFullYear()+"/"+("0"+(o.getUTCMonth()+1)).slice(-2)+"/"+("0"+o.getUTCDate()).slice(-2)+" "+("0"+o.getUTCHours()).slice(-2)+":"+("0"+o.getUTCMinutes()).slice(-2)+":"+("0"+o.getUTCSeconds()).slice(-2)+"."+this.digPadding(o.getUTCMilliseconds(),3);switch(d){case"error":console.error("%c"+t+"%c :: ERROR :: "+i+" :: "+a+" :: "+e,"display: inline-block; color: #fff; background: red; padding: 1px 4px; border-radius: 3px; font-size: x-small","background-color:white; color: #000; font-size: x-small");break;case"warning":console.warn("%c"+t+"%c :: INFO :: "+i+" :: "+a+" :: "+e,"display: inline-block; color: #fff; background: #3b88c3; padding: 1px 4px; border-radius: 3px; font-size: x-small","background-color:#fff; font-size: x-small");break;default:console.info("%c"+t+"%c :: INFO :: "+i+" :: "+a+" :: "+e,"display: inline-block; color: #fff; background: #3b88c3; padding: 1px 4px; border-radius: 3px; font-size: x-small","background-color:#fff; font-size: x-small")}}},timer:function(e,a,d){if(IOL.adv.timer)return e=e+"."+a,"start"!=d&&"stop"!=d||(IOL.adv.tools.timerContainer[e+d]=performance.now()),"partial"==d?(a=Math.floor(performance.now()-IOL.adv.tools.timerContainer[e+"start"]),IOL.adv.tools.timerContainer[e+d]=a):"elapsed"==d?Math.floor(performance.now()):void 0},loadJs:function(e,a,d,t,o){var i=IOL.adv.tools.classname+".loadJs",n=("string"==typeof t&&(t={id:t}),document.head||document.documentElement.childNodes[0]),s=document.createElement("script"),a=(s.async=!0,s.type="text/javascript","object"==typeof t&&Object.keys(t).forEach(function(e){s.setAttribute(e,t[e])}),a&&(s.onerror=a),d&&(s.onload=d),"https:"==document.location.protocol);if(s.src=(a||IOL.adv.pubAdsCfg.forceHttps?"https:":"http:")+e,"function"==typeof o)try{IOL.adv.tools.logger("run injectFunction",i),o(s)}catch(s){IOL.adv.tools.logger("error on injectFunction: "+e,i,"error")}else n.appendChild(s)},documentReady:function(e){let a=IOL.adv.tools.classname+".documentReady";IOL.adv.settings.validReadyState&&(IOL.adv.validReadyState=IOL.adv.settings.validReadyState),IOL.adv.tools.logger(`readyState: ${document.readyState}, accepted readyState: `+IOL.adv.validReadyState,a),IOL.adv.validReadyState.includes(document.readyState)?(IOL.adv.tools.logger(`readyState ${document.readyState} is valid, run `+e,a),e()):(IOL.adv.tools.logger("readyState is not valid, wait the onreadystatechange...",a),document.onreadystatechange=()=>{IOL.adv.validReadyState.includes(document.readyState)&&!IOL.adv.validReadyState.includes("done")&&(IOL.adv.tools.logger(`onreadystatechange :: readyState ${document.readyState} is valid, run `+e,a),IOL.adv.validReadyState.push("done"),e())})},divIdReady:function(e,a){var d=IOL.adv.tools.classname+".divIdReady",a=a||!1,t=!1;return e.divId&&(t="string"==typeof e.divId?a?document.getElementById(e.divId):null!==document.getElementById(e.divId):0<document.querySelectorAll(e.divId.regex).length,IOL.adv.tools.logger(`divId: ${e.divId}, ready: `+t,d)),t},divIdSwap:function(e,a,d){var t=IOL.adv.tools.classname+".divIdSwap";e>=a.divIdSwap.minW&&e<a.divIdSwap.maxW?(IOL.adv.tools.logger(d+" :: start swap ad container",t),IOL.adv.settings.prebidjs&&IOL.adv.settings.prebidjs.adUnits&&IOL.adv.settings.prebidjs.adUnits.find(IOL.adv.headerBidding.replaceAdunitByCode,{code:a.divId,newcode:a.divIdSwap.divId}),IOL.adv.tools.logger(`${d} :: override ${a.divId} with ${a.divIdSwap.divId}, minW: ${a.divIdSwap.minW} maxW: ${a.divIdSwap.maxW} page width: `+e,t),a.divIdSwap.divIdOri=a.divId,a.divId=a.divIdSwap.divId,a.divIdSwap.swapped=!0,IOL.adv.tools.logger("Try to set display:none for "+a.divIdSwap.divIdOri,t),document.getElementById(a.divIdSwap.divIdOri)?(document.getElementById(a.divIdSwap.divIdOri).style.display="none",IOL.adv.tools.logger("set display:none for "+a.divIdSwap.divIdOri,t)):IOL.adv.tools.logger(a.divIdSwap.divIdOri+" does not exist or is not ready yet",t),document.getElementById(a.divId)?(a.divIdReady=!0,document.getElementById(a.divId).style.display="block",IOL.adv.tools.logger("set divIdReady as true and display:block for "+a.divId,t)):IOL.adv.tools.logger(a.divId+" does not exist or is not ready yet",t)):(IOL.adv.tools.logger(`${d} :: swap ad container not required, set display:none on swap container: ${a.divIdSwap.divId}, minW: ${a.divIdSwap.minW}, maxW: ${a.divIdSwap.maxW}, page width: `+e,t),IOL.adv.tools.logger("Try to set display:none for "+a.divIdSwap.divId,t),document.getElementById(a.divIdSwap.divId)?(document.getElementById(a.divIdSwap.divId).style.display="none",IOL.adv.tools.logger("set display:none for "+a.divIdSwap.divId,t)):IOL.adv.tools.logger(a.divIdSwap.divId+" does not exist or is not ready yet",t),a.divIdSwap.swapped=!1)},validRangeSize:function(d,t,o){let i=IOL.adv.tools.classname+".validRangeSize";var n=!1;t.sizeIsCompliant=!1,Object.keys(t.validRangeSize).forEach(function(e){IOL.adv.tools.logger(o+" :: check validRangeSize for "+e,i);var a=t.validRangeSize[e];a&&(IOL.adv.tools.logger(o+" :: validRangeSize requested for "+e+" minW: "+a.minW+", maxW: "+a.maxW+", extraDivIdToHide: "+a.extraDivIdToHide,i),d>=a.minW&&d<=a.maxW?(IOL.adv.tools.logger(o+" :: page width "+d+" is compliant with min: "+a.minW+" and max: "+a.maxW,i),a.isCompliant=!0,a.extraDivIdToHide&&(n=a.extraDivIdToHide)):(IOL.adv.tools.logger(o+" :: page width "+d+" is not compliant with min: "+a.minW+" and max: "+a.maxW,i),a.isCompliant=!1,a.extraDivIdToHide&&(n=a.extraDivIdToHide),a.fallback&&a.fallback())),t.sizeIsCompliant=t.sizeIsCompliant||a.isCompliant}),t.sizeIsCompliant?IOL.adv.tools.logger(o+" :: page width is compliant with validRangeSize",i):(IOL.adv.tools.logger(o+" :: page width is not compliant with validRangeSize, destroy ad",i),document.getElementById(t.divId)&&(document.getElementById(t.divId).style.display="none",IOL.adv.tools.logger(o+" :: set display:none to "+t.divId,i)),n&&(document.getElementById(n)?(IOL.adv.tools.logger(o+" :: set display:none to extraDivIdToHide:"+n,i),document.getElementById(n).style.display="none"):IOL.adv.tools.logger(o+" :: extraDivIdToHide:"+n+" does not exist",i)),IOL.adv.settings.prebidjs&&IOL.adv.settings.prebidjs.adUnits&&(IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.rmAdunitByCode,{code:t.divId})),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[o].mediaType="disabledFromRangeSize")},mEnable:function(e){var a=!1,d="on"==IOL.adv.tools.getParameterByName(e),t=typeof(a=IOL.adv.settings.modules?IOL.adv.settings.modules[e]||!1:a);return"object"==t?(IOL.adv.settings.modules[e].enable=IOL.adv.settings.modules[e].enable||d,IOL.adv.settings.modules[e].enable&&"function"==typeof IOL.adv.settings.modules[e].f?IOL.adv.settings.modules[e].f():IOL.adv.settings.modules[e].enable):"boolean"==t?a||d:void 0},asHandler:function(e){let a=IOL.adv.classname+".asHandler";try{var d,t;IOL.adv.tools.logger("Start function, mode: "+e,a),IOL.adv.settings.dmp&&IOL.adv.settings.dmp["1plusx"]&&(IOL.adv.settings.dmp["1plusx"].tagger.enable&&"tagger"==e&&(IOL.adv.tools.logger("start 1plusx tagger...",a),o=window,i=document,n=IOL.adv.settings.dmp["1plusx"].tagger.url,o.ope=o.ope||function(){(o.ope.q=o.ope.q||[]).push(arguments)},(s=i.createElement("script")).async=1,s.src=n,(r=i.getElementsByTagName("script")[0]).parentNode.insertBefore(s,r),window.ope&&(window.ope("italiaonline","init","tcf2",{googleTopics:"true"}),t=!(d=[]),(t=IOL.adv.getProfile("ppid.iol"))&&d.push("IOL:"+t),(t=IOL.adv.getProfile("ppid.rtg"))&&d.push("RTG:"+t),0<d.length&&(IOL.adv.tools.logger(`send uuid to tagger [ ${d.join(",")} ]`,a),window.ope("italiaonline","syncIds",ids)),directoryData={},IOL.adv.pubAdsCfg.customCriteria.seat_categoria&&(directoryData.categoria=IOL.adv.pubAdsCfg.customCriteria.seat_categoria),IOL.adv.pubAdsCfg.customCriteria.seat_keyword&&(directoryData.keyword=IOL.adv.pubAdsCfg.customCriteria.seat_keyword),IOL.adv.pubAdsCfg.customCriteria.seat_settore&&(directoryData.settore=IOL.adv.pubAdsCfg.customCriteria.seat_settore),IOL.adv.pubAdsCfg.customCriteria.seat_geo1&&(directoryData.geo1=IOL.adv.pubAdsCfg.customCriteria.seat_geo1),IOL.adv.pubAdsCfg.customCriteria.seat_geo2&&(directoryData.geo2=IOL.adv.pubAdsCfg.customCriteria.seat_geo2),IOL.adv.pubAdsCfg.customCriteria.seat_geo3&&(directoryData.geo3=IOL.adv.pubAdsCfg.customCriteria.seat_geo3),0<Object.keys(directoryData).length)&&window.ope("italiaonline","send","directory-data",directoryData),IOL.adv.settings.dmp["1plusx"].tagger.enable=!1),IOL.adv.settings.dmp["1plusx"].api.enable)&&"api"==e&&(IOL.adv.tools.logger("start 1plusx api...",a),IOL.adv.tools.remoteCall(IOL.adv.settings.dmp["1plusx"].api.url+"?url="+encodeURIComponent(IOL.adv.url)+"&gdpr_applies=0","GET",!0,function(e){IOL.adv.tools.logger("1plusx api loaded",a),e?(e=JSON.parse(e),IOL.adv.tools.logger("User Profile 1plusx: "+JSON.stringify(e),a),e.s&&(IOL.adv.profile.as.value.s=e.s),e.t&&(IOL.adv.profile.as.value.t=e.t),e.sda&&(IOL.adv.profile.as.value.sda=e.sda),IOL.adv.profile.as.comingFrom="api",IOL.adv.settings.dmp["1plusx"].api.callback&&(IOL.adv.tools.logger("run callback: "+IOL.adv.settings.dmp["1plusx"].api.callback,a),IOL.adv.settings.dmp["1plusx"].api.callback(IOL.adv.profile.as.value.s))):IOL.adv.tools.logger("1plusx api empty",a)},2e3),IOL.adv.settings.dmp["1plusx"].api.enable=!1),IOL.adv.tools.logger("end function",a)}catch(e){}var o,i,n,s,r},setAdunitPathByBidderCode:function(e,a){var d=IOL.adv.tools.classname+".setAdunitPathByBidderCode",t=!1;IOL.adv.tools.logger("Start setAdunitPathByBidderCode on "+e.divId+" for bidder: "+a,d),IOL.adv.settings.prebidjs&&0<(t=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.getAdunitByCode,{code:e.divId})).length?(t.find(IOL.adv.headerBidding.setAdunitPathByBidderCode,{bidder:a,adUnitPath:e.adUnitPath}),IOL.adv.tools.logger("adUnit value after setAdunitPathByBidderCode : "+JSON.stringify(t),d)):IOL.adv.tools.logger("No setAdunitPathByBidderCode is required for "+e.divId,d)},displayAds:function(e){let a=IOL.adv.tools.classname+".displayAds";var d,t,o,i,n;IOL.adv.tools.logger("start function",a),IOL.adv.complete=!0,IOL.adv.pubAdsCfg.deferredDisplay||!IOL.adv.displayEngine.gpt?(IOL.adv.tools.logger(`nothing to do, deferredDisplay: ${IOL.adv.pubAdsCfg.deferredDisplay}, displayEngine gpt: `+IOL.adv.displayEngine.gpt,a),IOL.adv.tools.logger("IAM complete",a)):(d=void 0!==e&&void 0!==e.slotContainer&&e.slotContainer,t=void 0!==e&&void 0!==e.slotId&&e.slotId,o=void 0!==e&&void 0!==e.mode?e.mode:"standard",i=void 0===e||void 0===e.changeCorrelator||e.changeCorrelator,IOL.adv.tools.logger(`display engine: ${JSON.stringify(IOL.adv.displayEngine)}, slotContainer: ${JSON.stringify(d)}, mode: ${o}, changeCorrelator: `+i,a),n=[],t?n.push(IOL.adv.manager.slotsContainer[t]):d?e.slotContainer.forEach(function(e){n.push(e)}):Object.keys(IOL.adv.manager.slotsContainer).forEach(function(e){n.push(IOL.adv.manager.slotsContainer[e])}),IOL.adv.displayEngine.gpt&&(IOL.adv.tools.logger("display gpt",a),googletag.cmd.push(()=>{var e=!!IOL.adv.profile.enable&&(IOL.adv.pubAdsCfg.ppid||(IOL.adv.getProfile("ppid.iol")?IOL.adv.getProfile("ppid.iol"):!!IOL.adv.getProfile("ppid.fallback")&&IOL.adv.getProfile("ppid.fallback")));e?(IOL.adv.tools.logger("setPublisherProvidedId using ppid: "+e,a),googletag.pubads().setPublisherProvidedId(e)):IOL.adv.tools.logger("setPublisherProvidedId discarded",a),googletag.pubads().setPrivacySettings({nonPersonalizedAds:!IOL.adv.profile.enable,childDirectedTreatment:IOL.adv.profile.up.value.isMinor}),IOL.adv.tools.logger("Run setCustomCriteria",a),IOL.adv.manager.setCustomCriteria(),IOL.adv.tools.logger("run gpt refresh slot, changeCorrelator "+i,a),IOL.adv.tools.trkPerf("iamRenderingStart",Math.floor(performance.now()),!0),googletag.pubads().refresh(n,{changeCorrelator:i}),IOL.adv.tools.syncIds(["amazonId","liveramp","neustarPG"])})),IOL.adv.tools.logger("end function",a))},displayStaticBanner:function(a,e,d,t,o){o=IOL.adv.tools.classname+".displayStaticBanner,"+o;d()?a.staticBanner?(d=document.getElementById(a.divId))?(IOL.adv.tools.logger(a.divId+" : mode "+e+", staticBanner is compliant with this mode, ads config: "+JSON.stringify(a.staticBanner),o),t&&t(),d.replaceChildren(),a.staticBanner.html?(IOL.adv.tools.logger(a.divId+" : inject staticBanner html",o),d.innerHTML=a.staticBanner.html,a.staticBanner.script&&((t=document.createElement("script")).innerHTML=a.staticBanner.script,d.appendChild(t))):a.staticBanner.iframeSrc&&a.staticBanner.width&&a.staticBanner.height&&(IOL.adv.tools.logger(a.divId+" : inject staticBanner iframeSrc",o),(t=document.createElement("iframe")).setAttribute("src",a.staticBanner.iframeSrc),t.setAttribute("width",a.staticBanner.width),t.setAttribute("height",a.staticBanner.height),t.setAttribute("scrolling","no"),t.setAttribute("style","border: 0px;"),t.setAttribute("marginWidth","0"),t.setAttribute("marginheigth","0"),d.appendChild(t),d.display="block"),a.onRenderEnded.push({allowedSizes:["empty"],callback:function(e){document.getElementById(a.divId).style.display="block"}}),"function"==typeof a.staticBanner.onRenderEnded&&(IOL.adv.tools.logger("run onRenderEnded for staticBanner on: "+a.divId,o),a.staticBanner.onRenderEnded()),IOL.adv.complete=!0):IOL.adv.tools.logger(a.divId+" not found in page",o):IOL.adv.tools.logger("one or more attributes are not defined"+a.divId,o):IOL.adv.tools.logger(a.divId+" : mode "+e+", staticBanner is not compliant with this mode, ads config: "+JSON.stringify(a.staticBanner),o)},remoteCall:function(e,a,d,t,o){var i=IOL.adv.tools.classname+".remoteCall",o=o||2e4,n="GET"==a?"GET":"POST",a="GET"==n?"":a;IOL.adv.tools.logger("remoteCall url:"+e+", method: "+n,i);try{var s=new XMLHttpRequest;t&&(s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&200===s.status&&t(s.responseText)}),e=("https:"==document.location.protocol||IOL.adv.pubAdsCfg.forceHttps?"https:":"http:")+e,s.open(n,e,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),"GET"==n&&s.setRequestHeader("Referrer-Policy","no-referrer-when-downgrade"),s.datatype="json",d&&(s.withCredentials=d),s.onprogress=function(){},s.timeout=o,s.send(a)}catch(e){IOL.adv.tools.logger("err remoteCall e: "+e.message,i)}},getDomain:function(e){e=e.split(".");return 2<e.length&&e.shift(),"."+e.join(".")},getParameterByName:function(e){e=new RegExp("[?&]"+e.replace(/\[/g,"\\[").replace(/\]/g,"\\]")+"(?:=([^&#]*))?(?:[&#]|$)").exec(window.location.search);return e?e[1]?decodeURIComponent(e[1].replace(/\+/g," ")):"":null},extend:function(e,a){for(var d in a)a.hasOwnProperty(d)&&(e[d]=a[d]);return e},digPadding:function(e,a){return Array(Math.max(a-String(e).length+1,0)).join(0)+e},objAssigner:function(a,d){Object.keys(d).forEach(function(e){a[e]=d[e]})},getMetaTag:function(e,a){var d=[];try{var t=document.getElementsByTagName("meta")[e];if(null!=t&&null!=(t=t.getAttribute("content")))if(a)for(var t=t.split(a).filter(function(e){if(e)return!0}),o=0;o<t.length;o++)""!=t[o].replace(/\s/g,"")&&(d[o]=t[o].trim());else d=t}catch(e){}finally{return null!=d&&d}},getReferrerLabel:function(e,d){let t=IOL.adv.tools.classname+".getReferrerLabel";var o=d,i={site:[".*"+IOL.adv.domain.replace(/\./g,"\\.")+"$"],search:[/arianna\.libero\.it$/,/ricerca.*\.virgilio\.it$/,/.*\.google\.[a-z]{2,3}$/,/.*\.bing\.com$/,/.*\.ask\.[a-z]{2,3}$/,/.*\.hotbot\.[a-z]{2,3}$/,/.*\.dogpile\.[a-z]{2,3}$/,/.*\.lycos\.[a-z]{2,3}$/,/.*\.yandex\.[a-z]{2,3}$/,/.*\.exalead\.[a-z]{2,3}$/,/.*\.gigablast\.[a-z]{2,3}$/,/.*\.yahoo\.[a-z]{2,3}$/,/.*\.sogou\.[a-z]{2,3}$/,/.*\.search\.[a-z]{2,3}$/,/.*\.duckduckgo\.[a-z]{2,3}$/,/.*\.istella\.[a-z]{2,3}$/,/.*\.qwant\.[a-z]{2,3}$/,/.*\.searx\.[a-z]{2,3}$/,/.*\.qwant\.[a-z]{2,3}$/],linked:[/.*\.italiaonline\.it$/,/.*\.virgilio\.it$/,/.*\.libero\.it$/,/.*\.buonissimo\.it$/,/.*\.dilei\.it$/,/.*\.quifinanza\.it$/,/.*\.siviaggia\.it$/,/.*\.supereva\.it$/,/.*\.myblog\.it$/,/.*\.xoom\.it$/,/.*\.initalia\.it$/,/.*\.paginebianche\.it$/,/.*\.paginegialle\.it$/,/.*\.tuttocitta\.it$/,/.*\.seat\.it$/]};IOL.adv.tools.logger("page domain: "+IOL.adv.domain+", referrer: "+e,t);try{var n=(n=new URL(e).hostname.toLowerCase()).startsWith(".")?n:"."+n;IOL.adv.tools.logger("Referrer domain: "+n,t),Object.keys(i).forEach(function(e){for(var a=0;a<i[e].length&&o==d;a++)IOL.adv.tools.logger("Apply regEx: "+i[e][a]+" on domain: "+n+" for case: "+e,t),n.match(i[e][a])&&(o=e,IOL.adv.tools.logger("Match found, assign label: "+o,t))})}catch(e){IOL.adv.tools.logger("Referrer url is empty, return the default value: "+o,t)}finally{return o}},find:function(e,a){var d=IOL.adv.tools.classname+".find",t="";return IOL.adv.tools.logger("needle:"+e+" haystack:"+JSON.stringify(a),d),e&&a&&(IOL.adv.tools.logger("try to find needle in haystack",d),t=a[e]||""),IOL.adv.tools.logger("found: "+t,d),t},filterArrayInArray:function(a){let d=IOL.adv.tools.classname+".filterArrayInArray";var t=!0;return this.list.forEach(function(e){IOL.adv.tools.logger("prop:"+e+" typeof v:"+typeof a+" value: "+a,d),"object"==typeof a?a.join("x")==e.join("x")&&(IOL.adv.tools.logger("Bad size found",d),t=!1):(IOL.adv.tools.logger("Bad size found or not managed",d),t=!1)}),t},randomId:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()},randomInt:function(e,a){return e=Math.ceil(e),a=Math.floor(a),Math.floor(Math.random()*(a-e+1)+e)},inject:function(e){let a=IOL.adv.tools.classname+".inject";e.enable&&e.condition&&(IOL.adv.tools.logger("typeof condition: "+typeof e.condition,a),"function"==typeof e.condition)&&(e.enable=e.condition()),IOL.adv.tools.logger((e.enable?"loading":"discard")+" url: "+e.url+", enable: "+e.enable+", condition: "+e.condition,a),e.enable&&""!==e.url&&("function"==typeof e.url&&(e.url=e.url()),IOL.adv.tools.timer(a,e.url,"start"),IOL.adv.tools.loadJs(e.url,function(){e.live=!0,e.status="error",e.duration=IOL.adv.tools.timer(a,e.url,"partial"),IOL.adv.debug.tracking.adblock=!0,IOL.adv.tools.trkPerf("iamAdblock",Math.floor(performance.now())),e.onError&&e.onError()},function(){e.live=!0,e.status="loaded",e.duration=IOL.adv.tools.timer(a,e.url,"partial"),IOL.adv.tools.logger("Time elapsed for loading "+e.url+" is "+e.duration,a),e.onLoad&&e.onLoad()},e.id||!1,e.injectFunction||!1))},cmpHandler:function(e,a,d,t,o){let i=IOL.adv.tools.classname+".cmpHandler,"+e;var n,t=t||!1,o=o||!0;IOL.adv.gdpr.tcfv20.enable&&(IOL.adv.gdpr.enable=!0),IOL.adv.gdpr.enable||IOL.adv.settings.hasOwnProperty("tcfv20")&&"demand"==IOL.adv.settings.tcfv20.pipeline.method?(IOL.adv.tools.logger("cmp is ready or pipeline method is on demand, run callback function",i),a()):o?(IOL.adv.tools.logger("cmp is not ready yet, try with setInterval",i),n=0,t=setInterval(function(){IOL.adv.gdpr.enable="function"==typeof __tcfapi,IOL.adv.gdpr.enable?(clearInterval(t),IOL.adv.tools.logger("cmp is ready",i),a()):n>IOL.adv.gdpr.maxIteration?(IOL.adv.gdpr.timedOut=!0,clearInterval(t),IOL.adv.tools.logger("cmp is not ready, run fallback or callback function",i),d&&d()):(n++,IOL.adv.tools.logger("cmp is not ready yet, please wait...",i))},IOL.adv.gdpr.interval)):a()},getConsent:function(e,a){var d=IOL.adv.tools.classname+".getConsent",t={purpose:e?Array.isArray(e)?e:Array(e):[],vendor:a?Array.isArray(a)?a:Array(a):[]},o=!0;if(IOL.adv.gdpr.enable||(o=!1),o=IOL.adv.gdpr.tcfv20.tcData?o:!1)for(var i in t)for(var n=0;n<t[i].length;n++){if(!IOL.adv.gdpr.tcfv20.tcData.hasOwnProperty(i)||!IOL.adv.gdpr.tcfv20.tcData[i].hasOwnProperty("consents")){o=!1;break}var s=t[i][n];if(!IOL.adv.gdpr.tcfv20.tcData[i].consents[s]){o=!1;break}}return IOL.adv.tools.logger("Consent for: "+JSON.stringify(t)+" is "+o,d),o},trkPerf:function(e,a,d,t=!1){var o,i,n,s,r=IOL.adv.tools.classname+".trkPerf";try{if(IOL.adv.debug.tracking.enable)if(IOL.adv.debug.tracking.time[e]&&!t)IOL.adv.tools.logger("Track already done for "+e,r);else{IOL.adv.debug.tracking.time[e]=a;try{o=Date.now()}catch(e){o=0}try{i=screen.width}catch(e){i=0}try{n=window.location.hostname}catch(e){n="error"}try{s=IOL.adv.pubAdsCfg.segment||"all"}catch(e){s="all"}var l,v=[],g=("boolean"==typeof d&&d&&(v.push(IOL.adv.gdpr.consentGoogle?"consentGoogleTrue":"consentGoogleFalse"),v.push(IOL.adv.gdpr.enable?"gdprEnable":"gdprDisable"),v.push(IOL.adv.displayEngine.gpt?"displayGpt":"displayFallback"),v.push(IOL.adv.debug.tracking.adblock?"adblockTrue":"adblockFalse"),v.push(IOL.adv.headerBidding.prebidjs.enable?"hbTrue":"hbFalse"),v.push(IOL.adv.headerBidding.prebidjs.bids?"bids":"nobids"),v.push(IOL.adv.profile.up.value.up?"ssoTrue":"ssoFalse"),l=!!IOL.adv.profile.enable&&(IOL.adv.pubAdsCfg.ppid||(IOL.adv.getProfile("ppid.iol")?IOL.adv.getProfile("ppid.iol"):!!IOL.adv.getProfile("ppid.fallback")&&IOL.adv.getProfile("ppid.fallback"))),v.push(l?"ppidTrue":"ppidFalse"),v.push(IOL.adv.pubAdsCfg.ppid?"ppid1stPartyTrue":"ppid1stPartyFalse"),v.push(IOL.adv.getProfile("ppid.iol")?"ppidSSOTrue":"ppidSSOFalse"),v.push(IOL.adv.getProfile("ppid.fallback")?"ppidFallbackTrue":"ppidFallbackFalse")),"object"==typeof d&&Array.isArray(d)&&(v=d),"https://evnt.iol.it/v2?&pgnf="+n+","+s+",,,,,"+i+",0,,b,0,iam"+IOL.adv.version+";"+IOL.adv.settings.ns+(0<v.length?";"+v.join(";")+(1<v.length?";"+v.join("_"):""):"")+";connection:"+IOL.adv.connectionType+";downlink:"+Math.ceil(IOL.adv.downlink)+";connection:"+IOL.adv.connectionType+"_downlink:"+Math.ceil(IOL.adv.downlink)+","+e+","+a+"&nc="+o);(new Image).src=g,IOL.adv.tools.logger("track: "+e+", url: "+g,r)}else IOL.adv.tools.logger("Track druid disable",r)}catch(e){IOL.adv.tools.logger("track exception: "+e,r,"error")}},trkIdentity:function(e){var a=IOL.adv.tools.classname+".trkIdentity";try{var d=window.location.hostname,t=Date.now(),o="https://evnt.iol.it/v3?&pgnf="+d+","+e.partner+","+e.ppid+",,identity_id,,0,,,0,,,0,,,0,0,0&nc="+t;(new Image).src=o,IOL.adv.tools.logger("track: "+e.partner,a)}catch(e){IOL.adv.tools.logger("track exception: "+e,a,"error")}},trkVideo:function(e){var a,d,t,o,i=IOL.adv.tools.classname+".trkVideo";try{IOL.adv.tools.mEnable("trkVideo")?(a=IOL.adv.videoAds.bob.mailVersion||window.location.hostname,d=IOL.adv.videoAds.bob.from||"",t=Date.now(),o="https://evnt.iol.it/v2?&pgnf="+a+","+(IOL.adv.pubAdsCfg.segment||"all")+","+d+",,,,640,0,,,0,"+("iam"+IOL.adv.version+";"+IOL.adv.settings.ns+";"+["rel_"+e.reload,"req_"+e.count,"rel_"+e.reload+"_req_"+e.count,"connection:"+IOL.adv.connectionType,"downlink:"+Math.ceil(IOL.adv.downlink),"connection:"+IOL.adv.connectionType+"_downlink:"+Math.ceil(IOL.adv.downlink)].join(";"))+","+e.evnt+","+e.time+"&nc="+t,(new Image).src=o,IOL.adv.tools.logger("track: "+e.evnt+", url: "+o,i)):IOL.adv.tools.logger("Track druid disable for "+e.evnt,i)}catch(e){IOL.adv.tools.logger("track exception: "+e,i,"error")}},delElementById:function(e){let d=IOL.adv.tools.classname+".delElementById",a=Array.isArray(e)?e:Array(e);try{a.forEach(function(e){var a=document.getElementById(e);null!==a?(IOL.adv.tools.logger(e+" found, run d.parentNode.removeChild()",d),a.parentNode.removeChild(a)):IOL.adv.tools.logger(e+" not found",d)})}catch(e){IOL.adv.tools.logger("del id exception: "+e,d,"error")}},debugInit:function(){var a=IOL.adv.tools.classname+".debugInit";if(IOL.adv.debug.log.enable=!!IOL.adv.cookie.get(IOL.adv.debug.log.cookie.name,!0),IOL.adv.tools.getParameterByName("iam_console"))try{var e=JSON.parse(decodeURIComponent(IOL.adv.tools.getParameterByName("iam_console")));IOL.adv.tools.objAssigner(IOL.adv.pubAdsCfg,e),IOL.adv.debug.log.enable=IOL.adv.pubAdsCfg.log||IOL.adv.debug.log.enable,IOL.adv.debug.tracking.enable=IOL.adv.pubAdsCfg.tracking||IOL.adv.debug.tracking.enable,IOL.adv.debug.log.enable&&IOL.adv.cookie.set(IOL.adv.debug.log.cookie.name,"on",IOL.adv.debug.log.cookie.duration,"/",IOL.adv.domain,!0)}catch(e){IOL.adv.tools.logger('Error parsing debug parameter, please use the following specs: {"log":true,"console":true,"lazy":true,"prebid":false}, err: '+e.message,a,"error")}IOL.adv.debug.log.enable&&(IOL.adv.debug.log.id=IOL.adv.tools.randomId()),IOL.adv.debug.tracking.percentCustomerBase=IOL.adv.settings.percentCustomerBase||IOL.adv.debug.tracking.percentCustomerBase,IOL.adv.debug.tracking.randomInt=IOL.adv.tools.randomInt(1,100),(IOL.adv.debug.tracking.randomInt<=IOL.adv.debug.tracking.percentCustomerBase||IOL.adv.tools.mEnable("trkPerf"))&&(IOL.adv.debug.tracking.enable=void 0!==window.performance&&void 0!==window.performance.now),IOL.adv.tools.logger("log enable: "+IOL.adv.debug.log.enable+", track enable: "+IOL.adv.debug.tracking.enable,a)},reloadPageInDebugMode:function(){var e=-1!==(e=location.href).indexOf("?")?e+'&iam_console={"log":true}':e+'?iam_console={"log":true}';window.location.href=e},onRenderEnded:function(i,a){let n=IOL.adv.tools.classname+".onRenderEnded";a.listenerIam=e=>{e=IOL.adv.tools.getSlotAttribute(i,e);e&&(i.onRenderEnded.slotAttribute=e||i.onRenderEnded.slotAttribute,IOL.adv.tools.logger(i.divId+" :: slotAttribute from listenerIam: "+JSON.stringify(i.onRenderEnded.slotAttribute),n),IOL.adv.tools.startEvent(i,a,i.onRenderEnded.slotAttribute))},a.listenerGpt=e=>{IOL.adv.tools.slotIsEqualsToAd(e.slot.getSlotElementId(),i)&&(i.onRenderEnded.slotAttribute=IOL.adv.tools.getSlotAttribute(i,e),IOL.adv.tools.logger(i.divId+" :: slotAttribute from listenerGpt: "+JSON.stringify(i.onRenderEnded.slotAttribute),n),setTimeout(function(){try{let a=Number(i.onRenderEnded.slotAttribute.w||0),d=Number(i.onRenderEnded.slotAttribute.h||0);var e,t=document.getElementById(i.divId),o=!0;t&&(IOL.adv.tools.logger(`try to get real size for ${i.divId}, gpt returned size: ${a}x`+d,n),e=t.querySelectorAll('[id^="google_ads_iframe_"]'))&&(e.forEach(function(e){"iframe"==e.localName&&(e.getAttribute("width")&&e.getAttribute("width")!=i.onRenderEnded.slotAttribute.w&&(a=e.getAttribute("width")),e.getAttribute("height"))&&e.getAttribute("height")!=i.onRenderEnded.slotAttribute.h&&(d=e.getAttribute("height"))}),a=Number(a),d=Number(d),IOL.adv.tools.logger(`${i.divId} real size: ${a}x`+d,n),0===a&&0===d||(i.onRenderEnded.slotAttribute.w=a,i.onRenderEnded.slotAttribute.h=d))}catch(e){IOL.adv.tools.logger(i.divId+" : something went wrong, maybe ad isEmpty, msg: "+e.message,n,"warning"),o=!1}finally{IOL.adv.tools.logger(i.divId+" :: removeEventListener iam and gpt",n),document.removeEventListener("iamRenderEnded",a.listenerIam),googletag.pubads().removeEventListener("slotRenderEnded",a.listenerGpt),o&&IOL.adv.tools.startEvent(i,a,i.onRenderEnded.slotAttribute)}},200))},document.addEventListener("iamRenderEnded",a.listenerIam),googletag.pubads().addEventListener("slotRenderEnded",a.listenerGpt)},getSlotAttribute:function(e,a){IOL.adv.tools.classname;var d=!(!a.detail||"iamRenderEnded"!==a.type)&&a.detail,t=d?d.adUnitCode:a.slot.getSlotElementId(),o=d?d.width:!(a.isEmpty||!a.size)&&a.size[0],i=d?d.height:!(a.isEmpty||!a.size)&&a.size[1],n=!d&&!!a.hasOwnProperty("advertiserId")&&a.advertiserId,s=!d&&!!a.hasOwnProperty("creativeId")&&a.creativeId,a=d?"unknown":a.hasOwnProperty("lineItemId")&&a.lineItemId?a.lineItemId:a.hasOwnProperty("sourceAgnosticLineItemId")&&a.sourceAgnosticLineItemId?a.sourceAgnosticLineItemId:"unknown",d={slotId:t,displayFallback:!!d,w:o,h:i,advertiserId:n||!1,creativeId:s||!1,lineItemId:a||!1};return!!IOL.adv.tools.slotIsEqualsToAd(t,e)&&d},startEvent:function(e,a,d){var t=IOL.adv.tools.classname+".startEvent",o=d.slotId||!1;if(o){var i="function"!=typeof a.condition||a.condition(d);if(e.onRenderEnded.runned=e.onRenderEnded.hasOwnProperty("runned")?e.onRenderEnded.runned+1:1,IOL.adv.tools.logger(`${e.divId} :: condition: ${a.condition} is ${i}, runned `+e.onRenderEnded.runned,t),i)if((a.called=!1)!==d.w&&!1!==d.h)try{var n=d.w.toString().concat("x",d.h.toString()),s="function"==typeof a.allowedSizes?a.allowedSizes(n):a.allowedSizes.includes(n)||a.allowedSizes.includes("*");IOL.adv.tools.logger(e.divId+` :: size: ${n}, allowedSizes: ${a.allowedSizes}, valid: `+s,t),s?(IOL.adv.tools.logger(`${e.divId} :: size compliant, run callback: ${a.callback} on: ${o}, with slotAttribute: `+JSON.stringify(d),t),a.callback?(a.callback(Object.assign(d,{ad:e})),a.called=!0):IOL.adv.tools.logger(e.divId+" :: callback is not defined",t)):IOL.adv.tools.logger(e.divId+" :: size not compliant with AllowedSizes",t),e.onRenderEnded.runned===e.onRenderEnded.length&&(delete e.onRenderEnded.slotAttribute,e.onRenderEnded.runned=0)}catch(a){IOL.adv.tools.logger(`something went wrong for ${e.divId}, msg: `+(a.message||a),t)}else"function"!=typeof a.allowedSizes&&a.allowedSizes.includes("empty")&&(a.callback?(IOL.adv.tools.logger(e.divId+" :: run callback: "+a.callback+" on: "+o+", with size 'empty' on allowedSizes",t),a.callback(Object.assign(d,{ad:e})),a.called=!0):IOL.adv.tools.logger(e.divId+" :: callback is not defined",t));else e.onRenderEnded.runned===e.onRenderEnded.length&&(delete e.onRenderEnded.slotAttribute,e.onRenderEnded.runned=0)}else IOL.adv.tools.logger(e.divId+" :: slotId is not defined",t,"warning")},syncIds:function(a){let d=IOL.adv.tools.classname+".syncIds";if(IOL.adv.tools.logger("Start function",d),!IOL.adv.syncId.enable||IOL.adv.profile.up.value.isMinor)IOL.adv.tools.logger(`Sync disable :: enable: ${IOL.adv.syncId.enable}, isMinor: `+IOL.adv.profile.up.value.isMinor,d);else{IOL.adv.tools.logger("requested vendor(s) to sync: "+JSON.stringify(a),d);let e=IOL.adv.pubAdsCfg.ppid||!!IOL.adv.getProfile("ppid.zeo")&&IOL.adv.getProfile("ppid.zeo");if(a.includes("amazonId")&&IOL.adv.tools.mEnable("amazonId")&&window.apstag&&IOL.adv.syncId.vendor.amazon.enable&&!IOL.adv.syncId.vendor.amazon.done)if(IOL.adv.syncId.vendor.amazon.done=!0,e){IOL.adv.tools.logger("Sync amazonId with ppid: "+e,d),IOL.adv.headerBidding.apstagInit();var t={hashedRecords:[{type:"email",record:e}]};switch(IOL.adv.syncId.mode){case"del":window.apstag.dpa?(IOL.adv.tools.logger("Remove amazonId calling apstag.dpa",d),window.apstag.dpa()):IOL.adv.tools.logger("Sync amazonId apstag.dpa not ready yet...",d);break;case"upd":window.apstag.upa?(IOL.adv.tools.logger("Sync amazonId update calling apstag.upa with ppid: "+e,d),window.apstag.upa(t),IOL.adv.tools.trkIdentity({partner:"amazonid",ppid:e})):IOL.adv.tools.logger("Sync amazonId apstag.upa not ready yet...",d);break;default:window.apstag.rpa?(IOL.adv.tools.logger("Sync amazonId calling apstag.rpa with ppid: "+e,d),window.apstag.rpa(t),IOL.adv.tools.trkIdentity({partner:"amazonid",ppid:e})):IOL.adv.tools.logger("Sync amazonId apstag.rpa not ready yet...",d)}}else window.apstag.dpa?(IOL.adv.tools.logger("Remove amazonId calling apstag.dpa",d),window.apstag.dpa()):IOL.adv.tools.logger("Sync amazonId apstag.dpa not ready yet...",d);if(a.includes("neustarPG")&&IOL.adv.tools.mEnable("neustarPG")&&IOL.adv.syncId.vendor.neustarPG.enable&&!IOL.adv.syncId.vendor.neustarPG.done&&(IOL.adv.syncId.vendor.neustarPG.done=!0,IOL.adv.tools.loadJs("//pghub.io/js/pandg-sdk.js",!1,function(){IOL.adv.tools.logger("Sync neustarPG",d);var e={gdpr:IOL.adv.gdpr.consentString?1:0,gdpr_consent:IOL.adv.gdpr.consentString||"",bp_id:"iolitaly"};Tapad.init(e,{name:"P&G",pixelUrl:"//pandg.tapad.com/tag"}).sync({})})),a.includes("liveramp")&&IOL.adv.tools.mEnable("liveramp")&&IOL.adv.syncId.vendor.liveramp.enable&&!IOL.adv.syncId.vendor.liveramp.done&&(IOL.adv.syncId.vendor.liveramp.done=!0,e)&&IOL.adv.settings.modules.liveramp.url&&IOL.adv.tools.loadJs(IOL.adv.settings.modules.liveramp.url,!1,function(){IOL.adv.tools.logger("Sync liveramp with ppid: "+e,d),ats.setAdditionalData({type:"emailHashes",id:[e]}),IOL.adv.tools.trkIdentity({partner:"liveramp",ppid:e})},!1),a.includes("tncId")&&IOL.adv.syncId.vendor.tncId.enable&&!IOL.adv.syncId.vendor.tncId.done){IOL.adv.syncId.vendor.tncId.done=!0;let a=IOL.adv.pubAdsCfg.ppid||!!IOL.adv.getProfile("ppid.iol")&&IOL.adv.getProfile("ppid.iol");IOL.adv.tools.logger("Sync tncId with ppid: "+a,d);window.__tnc=window.__tnc||{},window.__tnc.providerId="10e652c5-8543-48f1-af62-31f6e635baa1",window.__tnc.options=window.__tnc.options||{autostart:!1},window.__tnc.ready=window.__tnc.ready||function(e){return window.__tnc.ready.q=window.__tnc.ready.q||[],window.__tnc.ready.q.push(e),__tnc},IOL.adv.tools.logger("load tncid js",d),IOL.adv.tools.loadJs("//js.tncid.app/route.js",!1,!1,{async:"",global:"__tnc",id:"tnc_route"}),a&&(window.__tnc_ppid=a),window.__tnc.ready(function(){IOL.adv.tools.logger("tncid ready, sync configuration",d),a&&(IOL.adv.tools.logger("window.__tnc.ready apply setConfig with ppid "+a,d),window.__tnc.setConfig({e:a})),window.__tnc.addCustomVariable("gdpr_consent","string",IOL.adv.gdpr.consentString),window.__tnc.on("data-sent",e=>{IOL.adv.tools.logger(`tncid try to setPublisherProvidedId using ${window.__tnc.tncid}, ppid: `+a,d),a?(IOL.adv.tools.logger("tncid set setPublisherProvidedId discarded, use first party data",d),IOL.adv.tools.trkIdentity({partner:"tncid",ppid:a})):window.__tnc.tncid&&(IOL.adv.profile.up.value.ppid=IOL.adv.tools.extend(IOL.adv.profile.up.value.ppid,{fallback:window.__tnc.tncid}),googletag.cmd.push(()=>{IOL.adv.tools.logger("tncid setPublisherProvidedId using tncid "+window.__tnc.tncid,d),googletag.pubads().setPublisherProvidedId(window.__tnc.tncid)}))}),__tnc.sendData()})}IOL.adv.tools.logger("End function",d)}},getBrowser:function(){var e=IOL.adv.settings.classname+".getBrowser",a=navigator.userAgent,a=a.match(/chrome|chromium|crios/i)?"chrome":a.match(/firefox|fxios/i)?"firefox":a.match(/safari/i)?"safari":a.match(/opr\//i)?"opera":!!a.match(/edg/i)&&"edge";return IOL.adv.tools.logger("Browser: "+a,e),a},autoRefresh:function(e){let r=IOL.adv.tools.classname+".autoRefresh";try{let a=e.config;if(!a)throw{msg:"configuration is missing",lvl:"error"};if(!a.ad)throw{msg:"ads not set",lvl:"error"};if(a.el=document.getElementById(a.ad.divId),!a.el)throw{msg:a.ad.divId+" not found",lvl:"warning"};if(a.percentView=a.percentView||51,a.maxRefresh=a.maxRefresh||30,a.interval=a.interval||3,a.thresholdViewTime=a.thresholdViewTime||("mobile"==IOL.adv.tools.getDevice()?15:20),a.thresholdDisplayTime=a.thresholdDisplayTime||("mobile"==IOL.adv.tools.getDevice()?120:150),a.minViewedTime=a.minViewedTime||10,a.boostOnFocusChange=a.boostOnFocusChange||!1,a.boostOnFocusChangeValue=a.boostOnFocusChangeValue||.25,a.disableOnEngage=a.disableOnEngage||!1,a.disabledForEngage=!1,a.ad.refresh.counter=a.ad.refresh.counter||0,a.callback=a.callback||function(){var e={...a.ad.customCriteria};a.ad.refresh.counter++,e.adv_arc=""+a.ad.refresh.counter,e["iat-imp-app"]="1",a.ad.lazy=!1,a.el.style.height=a.h+"px",IOL.adv.reloadAd(a.ad,{size:[[a.w,a.h]],setCollapseEmptyDiv:"DISABLED",sizeMapping:!1,customCriteria:e})},a.hasFocus=document.hasFocus(),a.ad.refresh.counter>=a.maxRefresh)throw{msg:a.ad.id+" max refresh reached",lvl:"info"};IOL.adv.tools.logger(a.ad.id+" :: config: "+JSON.stringify(e.config),r),a.ad.refresh.liHistory||(a.ad.refresh.liHistory=[]),a.lineItemId&&(a.ad.refresh.liHistory.push(a.lineItemId),IOL.adv.tools.logger(`liHistory [${a.ad.refresh.liHistory}]`,r));let d=function(i){IOL.adv.tools.logger(i.ad.id+" :: autorefresh is starting...",r);let n=0,s=0;var e=i.h;i.adsH=e-Math.floor(i.percentView/100*e),i.disableOnEngage&&(i.el.addEventListener("pointerenter",e=>{i.disabledForEngage=!0}),i.el.addEventListener("pointerout",e=>{i.disabledForEngage=!1})),i.ad.refresh.autoRefreshInterval&&(IOL.adv.tools.logger(i.ad.id+" :: destroy previous autorefresh interval",r),clearInterval(i.ad.refresh.autoRefreshInterval),i.ad.refresh.autoRefreshInterval=!1),i.ad.refresh.autoRefreshInterval=setInterval(function(){document.getElementById(i.ad.divId)||(clearInterval(i.ad.refresh.autoRefreshInterval),i.ad.refresh.autoRefreshInterval=!1,IOL.adv.tools.logger(i.ad.id+" :: stop autorefresh, ads container not found...",r));var e=i.el.getBoundingClientRect(),a=e.top+i.adsH,e=e.top+(e.height-i.adsH),d=document.hasFocus();let t=!1;var o=i.boostOnFocusChange&&d&&i.hasFocus!==d;n+=o?Math.floor(i.thresholdViewTime*i.boostOnFocusChangeValue):0,d&&0<=a&&0<=e&&e<=Math.min(document.documentElement.clientHeight,window.innerHeight||0)&&(n+=i.interval,t=!0),i.thresholdDisplayTime&&(s+=i.interval),IOL.adv.tools.logger(`${i.ad.id} :: hasFocus:${d}, focusChanged:${o}, inViewport:${t}, timeViewed:${n}, timeDisplayed:${s}, disabledForEngage:`+i.disabledForEngage,r),d&&!i.disabledForEngage&&(n>i.thresholdViewTime||s>i.thresholdDisplayTime&&n>i.minViewedTime&&t)&&(IOL.adv.tools.logger(i.ad.id+" :: threshold reached. Run callback...",r),clearInterval(i.ad.refresh.autoRefreshInterval),i.ad.refresh.autoRefreshInterval=!1,i.callback()),i.hasFocus=d},1e3*i.interval)};IOL.adv.liHistoryEligible.hasOwnProperty(a.lineItemId)?IOL.adv.liHistoryEligible[a.lineItemId]?d(a):IOL.adv.tools.logger(a.lineItemId+" autorefresh disabled for "+a.ad.id,r):IOL.adv.tools.remoteCall(IOL.adv.server+"/service/ar",`li=${a.lineItemId}&ai=${a.advertiserId}&adid=`+a.ad.id,!0,function(e){IOL.adv.tools.logger(a.ad.id+" :: response from remote host: "+e,r);e=JSON.parse(decodeURIComponent(e));IOL.adv.liHistoryEligible[a.lineItemId]=e.ar,e.ar?d(a):IOL.adv.tools.logger("autorefresh disabled for "+a.ad.id,r)})}catch(e){IOL.adv.tools.logger(e.msg,r,e.lvl)}},parseUp:function(e){var a,d=IOL.adv.settings.classname+".parseUp";IOL.adv.profile.up.value.up?(IOL.adv.profile.up.comingFrom=e||"unknow",0<(a=IOL.adv.profile.up.value.up.split("-")).length&&(IOL.adv.profile.up.value.age=a[0]||"0",IOL.adv.profile.up.value.gender=a[1]||"0",IOL.adv.profile.up.value.province=a?a[2]:"0"),IOL.adv.profile.up.value.isMinor="x"==IOL.adv.profile.up.value.age,IOL.adv.tools.logger(JSON.stringify(IOL.adv.profile.up.value)+", coming from: "+e,d)):IOL.adv.tools.logger("up is empty, coming from: "+e,d)},initAds:function(){let t=IOL.adv.tools.classname+".initAds";IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].initAdsDone?IOL.adv.tools.logger("Ads already initialized for slot "+IOL.adv.pubAdsCfg.slot,t):(IOL.adv.tools.logger("start function",t),IOL.adv.tools.logger("init ads for slot "+IOL.adv.pubAdsCfg.slot,t),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].initAdsDone=!0,Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(e){IOL.adv.tools.logger("init ads "+e,t);var a=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e],d=(a.id=e,a.mediaType=void 0!==a.mediaType?a.mediaType:"display",a.size=null==a.size?[]:a.size,a.lazy=void 0===a.lazy||a.lazy,a.optional=void 0!==a.optional&&a.optional,a.customCriteria=void 0!==a.customCriteria&&a.customCriteria,a.sizeIsCompliant=!0,a.onRenderEnded=a.onRenderEnded?Array.isArray(a.onRenderEnded)?a.onRenderEnded:Array(a.onRenderEnded):[],a.refresh=void 0!==a.refresh?a.refresh:{autorefresh:!1,autoRefreshInterval:!1,initialized:!1,ts:!1,gap:3e3,counter:0},"function"==typeof a.refresh.autorefresh?a.refresh.autorefresh():a.refresh.autorefresh);a.refresh.initialized=a.refresh.initialized||!1,a.refresh.autoRefreshInterval=!1,d&&!a.refresh.initialized?(IOL.adv.tools.logger(a.id+" :: autorefresh enabled",t),a.refresh.initialized=!0,a.onRenderEnded.push({allowedSizes:function(e){return!["1x1","1800x1000","1798x90","1200x90","300x1","320x160","970x270","0x270","1000x90"].includes(e)},callback:function(e){IOL.adv.tools.autoRefresh({config:{ad:e.ad,h:e.h,w:e.w,advertiserId:e.advertiserId,lineItemId:e.lineItemId,boostOnFocusChange:!1,boostOnFocusChangeValue:.25,disableOnEngage:!0,percentView:51,thresholdViewTime:"mobile"==IOL.adv.tools.getDevice()?15:20,thresholdDisplayTime:"mobile"==IOL.adv.tools.getDevice()?150:200,minViewedTime:5,maxRefresh:!1,interval:2}})}})):IOL.adv.tools.logger(`autorefresh disabled for ${a.id}, initialized: `+a.refresh.initialized,t),"video"==a.mediaType&&(a.size=[[640,480]],a.divIdReady=!0,a.lazy=!1),a.validRangeSize&&(IOL.adv.tools.logger(e+" :: validRangeSize has been requested",t),IOL.adv.tools.validRangeSize(IOL.adv.pageWidth,a,e))}),IOL.adv.tools.logger("end function",t))},geoedgeCondition:function(){var e=IOL.adv.settings.classname+".geoedgeCondition",a=!!(IOL.adv.pageWidth<=640||"safari"==IOL.adv.browser||IOL.adv.pubAdsCfg.antiMalware);return IOL.adv.tools.logger("geoedge condition: "+a,e),a},pbjsHybridCondition:function(){var e=IOL.adv.tools.classname+".pbjsHybridCondition",a=!1;return IOL.adv.headerBidding.pbjsHybrid&&(a=IOL.adv.headerBidding.pbjsHybrid.hasOwnProperty("condition")?"function"==typeof IOL.adv.headerBidding.pbjsHybrid.condition&&IOL.adv.headerBidding.pbjsHybrid.condition():IOL.adv.pageWidth<=728),IOL.adv.tools.logger("pbjsHybrid condition: "+a,e),a},filteringPbjsHybrid:function(e){var a=IOL.adv.headerBidding.classname+".filteringPbjsHybrid",d=e,t=!1,o=IOL.adv.headerBidding.pbjsHybrid;switch(Object.keys(d.mediaTypes)[0]){case"video":"instream"===d.mediaTypes.video.context?t=!!o.hasOwnProperty("videoInstream")&&o.videoInstream:"outstream"===d.mediaTypes.video.context&&(t=!!o.hasOwnProperty("videoOutstream")&&o.videoOutstream);break;case"native":t=!!o.hasOwnProperty("native")&&o.native;break;default:t=!!o.hasOwnProperty("display")&&o.display}IOL.adv.tools.logger("pbjsHybrid filtering - mediaTypes:"+Object.keys(d.mediaTypes)[0]+("video"===Object.keys(d.mediaTypes)[0]?"("+d.mediaTypes.video.context+")":"")+", adunit:"+d.code+", bidders:"+(t&&t.join(",")),a),t&&(d.bids=d.bids.filter(function(e){return t.includes(e.bidder)}))},getDevice:function(){return IOL.adv.pageWidth<728?"mobile":728<=IOL.adv.pageWidth&&IOL.adv.pageWidth<=1024?"tablet":"desktop"},getSizeMapping:function(e){try{return Object.values(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].sizeMapping||{}).sort(function(e,a){return e[0][0]-a[0][0]}).filter((e,a,d)=>!(d[a][0][0]>IOL.adv.pageWidth)).slice(-1)[0]||!1}catch(e){}return!1},slotIsEqualsToAd:function(e,a){var d=IOL.adv.tools.classname+".slotIsEqualsToAd";let t=!1;try{t=e===a.divId||e===IOL.adv.manager.slotsContainer[a.id].getSlotElementId()}catch(e){IOL.adv.tools.logger("something went wrong: "+e,d,"warning")}finally{return IOL.adv.tools.logger(`${e} is equals to ${a.id}: `+t,d),t}},utHandler:function(e){try{var a=IOL.adv.tools.classname+".utHandler";if(IOL.adv.pubAdsCfg.ut||IOL.adv.settings.ut){if(IOL.adv.pubAdsCfg.ut.toLowerCase()===IOL.adv.settings.ut)if(IOL.adv.profile.enable=!1,IOL.adv.deviceAccess.enable=!1,IOL.adv.syncId.enable=!1,IOL.adv.gdpr.consentGoogle=!1,"disable3rdPartyLibrary"===e){for(var d in IOL.adv.tools.logger("pubAdsCfg.ut disable3rdPartyLibrary",a),IOL.adv.settings.dmp&&(IOL.adv.settings.dmp["1plusx"].tagger.enable=!1,IOL.adv.settings.dmp["1plusx"].api.enable=!1),IOL.adv.settings.modules)"boolean"==typeof IOL.adv.settings.modules[d]?IOL.adv.settings.modules[d]=!1:IOL.adv.settings.modules[d].enable&&(IOL.adv.settings.modules[d].enable=!1);for(var t in IOL.adv.settings.library)"prebid"!=t&&"platform"!=t&&(IOL.adv.settings.library[t].enable=!1)}else if(IOL.adv.tools.logger("pubAdsCfg.ut tcfv20",a),-1!=Object.values(IOL.adv.gdpr.tcfv20.tcData.purpose.consents).slice(0,10).indexOf(!0)){IOL.adv.tools.logger("stack autopromo",a),IOL.adv.pubAdsCfg.prebid=!1;try{Boolean(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo)&&IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.adUnitPathBasic&&(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.adUnitPath=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.adUnitPathBasic,delete IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo.adUnitPathOverride,IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.rmAdunitByCode,{code:"iol_player_container"}))}catch(e){}for(var o in IOL.adv.displayEngine={gpt:!1,staticBanner:!0},IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads)try{var i=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[o];i.hasOwnProperty("mgid")&&delete i.mgid,i.hasOwnProperty("staticBanner")&&"ut"==i.staticBanner.type&&(i.staticBanner.width&&i.staticBanner.height?i.staticBanner.iframeSrc||(i.staticBanner.iframeSrc=`//i.plug.it/banners/html/ut.html?ns=${IOL.adv.settings.ns}&w=${i.staticBanner.width}&h=`+i.staticBanner.height,i.staticBanner.condition=function(e,a){return a}):delete i.staticBanner)}catch(e){}var n=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic;n&&n.staticBanner&&"ut"==n.staticBanner.type&&(n.staticBanner.width&&n.staticBanner.height?n.staticBanner.iframeSrc||(n.staticBanner.iframeSrc=`//i.plug.it/banners/html/ut.html?ns=${IOL.adv.settings.ns}&w=${n.staticBanner.width}&h=`+n.staticBanner.height,n.staticBanner.condition=function(e,a){return a}):delete n.staticBanner)}}else IOL.adv.tools.logger("ut not requested",a)}catch(e){}},getCustomParams:function(){var e=IOL.adv.getProfile(),a=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].video||IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads.advideo,d=!!Boolean(e.audience.sda[528]&&0<e.audience.sda[528].length)&&e.audience.sda[528].join(",");IOL.adv.videoAds.trueview.param=IOL.adv.videoAds.reqCounter<=IOL.adv.videoAds.trueview.threshold?"&trueview=yes":"&trueview=no";let t="";return Object.keys(IOL.adv.pubAdsCfg.customCriteria).forEach(function(e){""!==IOL.adv.pubAdsCfg.customCriteria[e]&&(t+=encodeURIComponent(`&${e}=`+String(IOL.adv.pubAdsCfg.customCriteria[e]).replace(/\|/g,",")))}),""+(IOL.adv.profile.up.value.isMinor?"":encodeURIComponent("adv_sso1="+e.age+"&adv_sso2="+e.gender))+encodeURIComponent(0<e.audience.s.length&&IOL.adv.profile.enable&&!IOL.adv.profile.up.value.isMinor?"&1plusx="+e.audience.s.join(","):"")+encodeURIComponent(0<e.audience.t.length?"&ctx1plusx="+e.audience.t.join(","):"")+encodeURIComponent(IOL.adv.profile.enable&&!IOL.adv.profile.up.value.isMinor&&d?"&sda528="+d:"")+(IOL.adv.videoAds.trueview.param?encodeURIComponent(IOL.adv.videoAds.trueview.param):"")+(IOL.adv.topics?encodeURIComponent("&adv_topics="+IOL.adv.topics.join(",")):"")+t+(IOL.adv.referrerLabel?encodeURIComponent("&adv_referrer="+IOL.adv.referrerLabel):"")+(IOL.adv.headerBidding.prebidjs.enable?encodeURIComponent("&pbjs_version="+IOL.adv.headerBidding.prebidjs.version):"")+(IOL.adv.pubAdsCfg.native?encodeURIComponent("&native="+IOL.adv.pubAdsCfg.native):"")+encodeURIComponent("&us_ua="+(IOL.adv.profile.up.value.isMinor?"true":"false"))+encodeURIComponent("&npa="+(IOL.adv.profile.enable?"0":"1"))+(IOL.adv.tools.getParameterByName("kw_test")?encodeURIComponent("&kw_test="+IOL.adv.tools.getParameterByName("kw_test")):"")+encodeURIComponent("&inventory_type=browsable")+encodeURIComponent("&downlink="+IOL.adv.downlink)+encodeURIComponent("&schainsid="+(IOL.adv.headerBidding.supplyChainSid||"54356"))+(a.adServerUrlAppendCustomParams?encodeURIComponent(a.adServerUrlAppendCustomParams):"")},injectPlayer:(s="iol-player-container-outofpage")=>{let r=IOL.adv.tools.classname+".injectPlayer";try{if(IOL.adv.tools.logger("Start function",r),!Reflect.has(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot],"video"))throw{msg:`slot ${IOL.adv.pubAdsCfg.slot} does not have video config`,lvl:"info"};var e=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].video;let o=e.playerType||"embed";if(!(e.condition?"function"==typeof e.condition?e.condition():Boolean(e.condition):"outofpage"===o?IOL.adv.pubAdsCfg.customCriteria&&Boolean(IOL.adv.pubAdsCfg.customCriteria.adv_playertv):Reflect.has(IOL.adv.pubAdsCfg,"player")&&0<IOL.adv.pubAdsCfg.player.length))throw{msg:"condition is false for video "+o,lvl:"info"};if("outofpage"===o){if(!e.zid)throw{msg:"zid not defined for video "+o,lvl:"warning"};IOL.adv.pubAdsCfg.player=[{zid:e.zid}]}let i=e.adUnitPath;IOL.adv.pubAdsCfg.section&&IOL.adv.settings.sectionMap&&(i=IOL.adv.settings.sectionMap[IOL.adv.pubAdsCfg.section]?i.replace("%SECTION%",IOL.adv.settings.sectionMap[IOL.adv.pubAdsCfg.section]):i.replace("%SECTION%",IOL.adv.settings.sectionMap.default)),void 0===window._ABTestingTrack||/test[A|B|C]$/.test(i)||(i+="/test"+window._ABTestingTrack.toUpperCase()),6<(i=IOL.adv.test.enable?i.replace("%PLACEHOLDER%",IOL.adv.test.value):i).split("/").filter(e=>e).length&&IOL.adv.tools.logger(`adUnitPath level for ad ${id}: ${i} is greater than accepted`,r,"warning"),window.vpt=window.vpt||{},window.vpt.queue=window.vpt.queue||[],IOL.adv.profile.up.value.ppid.iol&&window.vpt.queue.push(function(){IOL.adv.tools.logger("Set publisher provided id: "+IOL.adv.profile.up.value.ppid.iol,r),window.vpt.setPublisherProvidedId(IOL.adv.profile.up.value.ppid.iol)});let n=e.delay||0;IOL.adv.pubAdsCfg.player.forEach(d=>{IOL.adv.tools.logger(`playerType: ${o}, adUnitPath: ${i}, delay: ${n}, cid: ${d.cid}, zid: ${d.zid}, divId: `+(d.div||s),r);var t=new URL("https://content.viralize.tv/display/");if(s=d.div||s,!d.cid||document.getElementById(d.div)){d.cid&&t.searchParams.append("cid",d.cid),t.searchParams.append("zid",d.zid),t.searchParams.append("pub_iu",i),t.searchParams.append("pub_npa",IOL.adv.profile.enable?"0":"1"),t.searchParams.append("pub_tfcd",IOL.adv.profile.up.value.isMinor?"1":"0"),t.searchParams.append("pub_cust_params",decodeURIComponent(IOL.adv.tools.getCustomParams()));let e=document.createElement("script"),a=(e.setAttribute("src",t.href),e.setAttribute("data-wid","auto"),e.setAttribute("type","text/javascript"),"embed"===o?document.getElementById(s):document.createElement("div"));setTimeout(()=>{a.innerHTML="",a.setAttribute("id",s),a.appendChild(e),a.style="","outofpage"===o&&document.body.appendChild(a),IOL.adv.tools.logger(`injection done for ${o} video`,r)},n)}})}catch(e){IOL.adv.tools.logger(e.msg,r,e.lvl)}},setTargeting:function(e,a){var d=IOL.adv.tools.classname+".setTargeting";try{if("object"!=typeof a&&null!==a)throw{msg:"targets must be an object or null",lvl:"error"};(e?(IOL.adv.tools.logger(`run gpt set targeting ${JSON.stringify(a)} on slot level`,d),e):(IOL.adv.tools.logger(`run gpt set targeting ${JSON.stringify(a)} on page level`,d),googletag)).setConfig({targeting:a})}catch(e){IOL.adv.tools.logger(e.msg,d,e.lvl)}}},IOL.adv.cookie={get:function(e,a){let d=!1;if(IOL.adv.deviceAccess.enable||a){var t=e.split(","),o=document.cookie.split(";"),i=o.length;for(let e=0;e<t.length;e++){var n=t[e]+"=";for(let a=0;a<i;a++){let e=o[a];for(;" "==e.charAt(0);)e=e.substring(1,e.length);0===e.indexOf(n)&&(d=e.substring(n.length,e.length))}}}return d},set:function(e,a,d,t,o,i){(IOL.adv.deviceAccess.enable||i)&&((i=new Date).setDate(i.getDate()+d),document.cookie=e+"="+escape(a)+(null===d?"":"; expires="+i.toUTCString())+"; Secure; SameSite=Strict; path="+(void 0===t?"/":t)+"; domain="+(o||IOL.adv.domain))},erase:function(e,a){document.cookie=e+"=; Max-Age=0; path=/; domain="+(a||IOL.adv.domain)},enabled:function(){if(!IOL.adv.deviceAccess.enable)return!1;this.set(IOL.adv.domain,"probe","ok",1);var e="ok"==this.get("probe");return this.set(IOL.adv.domain,"probe","",-1),e}},IOL.adv.settings={classname:"IOL.adv.settings",ns:"virgilio.web.webmail.login.1.1",modules:{antiAdBlock:!0,trkPerf:!1},amazonUseSafeFrames:!0,library:{geoedge:{enable:!0,mandatory:!0,url:"//rumcdn.geoedge.be/grumi-ip.js",live:!1,condition:function(){return IOL.adv.pageWidth<=640||"4g"!=IOL.adv.connectionType}},platform:{enable:!0,mandatory:!0,url:"//securepubads.g.doubleclick.net/tag/js/gpt.js",live:!1},prebid:{enable:!0,mandatory:!0,url:"//www.iolam.it/js/prebid.js",live:!1,condition:function(){return IOL.adv.pubAdsCfg.prebid}},amazon:{enable:!0,mandatory:!0,url:"//c.amazon-adsystem.com/aax2/apstag.js",injectFunction:!((d,t)=>{function e(e,a){t[d]._Q.push([e,a])}t[d]||(t[d]={init:function(){e("i",arguments)},fetchBids:function(){e("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]})})("apstag",window,document),live:!1,condition:function(){return IOL.adv.pubAdsCfg.prebid||IOL.adv.tools.mEnable("amazonId")}},intersectionObserver:{enable:!0,mandatory:!0,url:"//www.iolam.it/js/polyfill/intersection-observer.js",live:!1,condition:function(){return"function"!=typeof IntersectionObserver&&IOL.adv.pubAdsCfg.lazy}},yieldbird:{enable:!0,mandatory:!1,url:function(){return window.googletag=window.googletag||{cmd:[]},window.ybConfiguration=window.ybConfiguration||{},window.ybConfiguration=Object.assign({},window.ybConfiguration,{integrationMethod:"open_tag"}),window.Yieldbird=window.Yieldbird||{},window.Yieldbird.cmd=window.Yieldbird.cmd||[],"//cdn.qwtag.com/b61849c3-7482-4e99-ba34-32dad1622fd8/qw.js"},live:!1}},dmp:{"1plusx":{tagger:{enable:!1,url:"https://cdn.opecloud.com/ope-italiaonline.js"},api:{enable:!0,url:"//italiaonline.profiles.tagger.opecloud.com/v1/targeting"}}},disableInitialLoad:!0,enableSingleRequest:!0,enableAsyncRendering:!0,lazy:{observer:{obj:null,options:{threshold:[.001],rootMargin:"400px 0px 400px 0px"}},divIdSlotIdMap:{}},slots:{default:{fnInit:function(){IOL.adv.settings.fnInit()},ads:{adsplash:{adUnitPath:"/5180/virgilio/webmail/login",divId:"adsplash",optional:"true",size:[[1540,1024]],validRangeSize:{desktop:{minW:993,maxW:9999}},setCollapseEmptyDiv:"ON_NO_FILL",forceSafeFrame:!1,bidAmazon:!0,fnBefore:function(e,a){IOL.adv.settings.fnBeforeAdSplash(e,a)},fnAfter:function(e,a){IOL.adv.settings.fnAfterAdSplash(e,a)}},adleaderboard:{adUnitPath:"/5180/virgilio/webmail/login",divId:"adleaderboard",optional:"true",size:[[728,90]],validRangeSize:{tablet:{minW:731,maxW:992}},setCollapseEmptyDiv:"ON_NO_FILL",forceSafeFrame:!1,bidAmazon:!0,fnBefore:function(e,a){IOL.adv.settings.fnBeforeAdLeaderboard(e,a)},fnAfter:!1},admpu:{adUnitPath:"/5180/virgilio/webmail/login",divId:"admpu",optional:"true",size:[[300,250],[600,800]],validRangeSize:{mobile:{minW:320,maxW:730}},setCollapseEmptyDiv:"ON_NO_FILL",forceSafeFrame:!1,bidAmazon:!0,fnBefore:function(e,a){IOL.adv.settings.fnBeforeAdMpu(e,a)},fnAfter:!1}},fnFinally:!1},test:{fnInit:function(){IOL.adv.settings.fnInit()},ads:{adsplash:{adUnitPath:"/5180/testiol/virgilio/login/test%PLACEHOLDER%",divId:"adsplash",optional:"true",size:[[1540,1024]],validRangeSize:{desktop:{minW:993,maxW:9999}},setCollapseEmptyDiv:"ON_NO_FILL",forceSafeFrame:!1,bidAmazon:!1,fnBefore:function(e,a){IOL.adv.settings.fnBeforeAdSplash(e,a)},fnAfter:function(e,a){IOL.adv.settings.fnAfterAdSplash(e,a)}},adleaderboard:{adUnitPath:"/5180/testiol/virgilio/login/test%PLACEHOLDER%",divId:"adleaderboard",optional:"true",size:[[728,90]],validRangeSize:{tablet:{minW:731,maxW:992}},setCollapseEmptyDiv:"ON_NO_FILL",forceSafeFrame:!1,bidAmazon:!1,fnBefore:function(e,a){IOL.adv.settings.fnBeforeAdLeaderboard(e,a)},fnAfter:!1},admpu:{adUnitPath:"/5180/testiol/virgilio/login/test%PLACEHOLDER%",divId:"admpu",optional:"true",size:[[300,250],[600,800]],validRangeSize:{mobile:{minW:320,maxW:730}},setCollapseEmptyDiv:"ON_NO_FILL",forceSafeFrame:!1,bidAmazon:!1,fnBefore:function(e,a){IOL.adv.settings.fnBeforeAdMpu(e,a)},fnAfter:!1}},fnFinally:!1}},fnInit:function(){var e,a=IOL.adv.settings.classname+".fnInit";try{if(IOL.adv.deviceAccess.enable){if(localStorage&&"undefined"!=pubAdsCfg.location&&("step1"==pubAdsCfg.location||"step2"==pubAdsCfg.location)){window.addEventListener("beforeunload",function(e){{var a=pubAdsCfg.location,d=Math.floor(performance.now());a+="time";let e=JSON.parse(localStorage.getItem(a));e.unshift(d),e=e.slice(0,10),localStorage.setItem(a,JSON.stringify(e))}});{var d=pubAdsCfg.location;d+="time";let e=JSON.parse(localStorage.getItem(d));e||(e=Array(10).fill("x"),localStorage.setItem(d,JSON.stringify(e))),e}}function t(e){e=(JSON.parse(localStorage.getItem(e+"time"))||[]).map(e=>parseFloat(e)).filter(e=>!isNaN(e));return 5<=e.length?e.reduce((e,a)=>e+a,0)/e.length:null}t(pubAdsCfg.location)<5e3&&(IOL.adv.manager.customCriteria.map=IOL.adv.tools.extend(IOL.adv.manager.customCriteria.map,{adv_type:{condition:!0,value:"login_redirect_disabled"}})),5e3<=t(pubAdsCfg.location)&&(IOL.adv.manager.customCriteria.map=IOL.adv.tools.extend(IOL.adv.manager.customCriteria.map,{adv_type:{condition:!0,value:"login_redirect_enabled"}}))}}catch(e){}try{"string"==typeof pubAdsCfg.location&&("step1"==pubAdsCfg.location&&(IOL.adv.tools.logger("step1: remove items adv_st_active, adv_st_storyid",a),sessionStorage.removeItem("adv_st_active"),sessionStorage.removeItem("adv_st_storyid")),"step2"==pubAdsCfg.location)&&("yes"==sessionStorage.getItem("adv_st_active")?(IOL.adv.pubAdsCfg.prebid=!1,(e=window.googletag||{}).cmd=e.cmd||[],e.cmd.push(function(){var e=!!sessionStorage.getItem("adv_st_storyid")&&sessionStorage.getItem("adv_st_storyid");e?(IOL.adv.tools.logger("step2: call setTargeting adv_st_active, adv_st_storyid: "+e,a),IOL.adv.tools.setTargeting(!1,{adv_st_active:"yes",adv_st_storyid:e})):IOL.adv.tools.logger("step2: adv_st_storyid not found",a)})):IOL.adv.tools.logger("step2: adv_st_active not found",a))}catch(e){IOL.adv.tools.logger("Some problems here, e: "+e.message,a,"error")}},fnAfterAdSplash:function(e,i){googletag.pubads().addEventListener("slotRenderEnded",function(e){var a=IOL.adv.settings.classname+".fnAfterAdSplash";try{var d,t,o=e.slot.getSlotElementId();IOL.adv.tools.logger("slotId: "+o+" ad.divId: "+i.divId+" event.isEmpty: "+e.isEmpty,a),o==i.divId&&!e.isEmpty&&e.size?(d=e.size[0],IOL.adv.headerBidding.prebidjs.enable&&Object.keys(pbjs.getAllWinningBids()).forEach(function(e){IOL.adv.tools.logger("HeaderBidding Winning Bids: "+pbjs.getAllWinningBids()[e].adUnitCode,a),pbjs.getAllWinningBids()[e].adUnitCode==i.divId&&(d=pbjs.getAllWinningBids()[e].width,IOL.adv.tools.logger("Get size from HeaderBidding Winning Bids",a))}),IOL.adv.tools.logger("ads width: "+d,a),300==d&&(IOL.adv.tools.logger("Calling get_editorial function",a),get_editorial())):o==i.divId&&e.isEmpty&&993<IOL.adv.pageWidth&&(IOL.adv.tools.logger("Calling get_editorial function",a),get_editorial(),adv_anchor.style.height="600px",adv_anchor.style.width="300px",(t=new Image(300,600)).src="https://i3.plug.it/banners/img/pec_vir_300x600.jpg",document.getElementById("adsplash").style.setProperty("max-width","300px","important"),document.getElementById("adsplash").appendChild(adv_anchor),adv_anchor.appendChild(t))}catch(e){}})},fnFinally:function(){IOL.adv.settings.classname},fnBeforeAdSplash:function(e,a){IOL.adv.gdpr.consentGoogle||(a.setCollapseEmptyDiv="BEFORE_FETCH");IOL.adv.settings.classname;try{"undefined"!=pubAdsCfg.location&&(a.adUnitPath=a.adUnitPath.concat("/"+pubAdsCfg.location)),void 0===pubAdsCfg.location||"string"==typeof sessionStorage.getItem("adv_st_active")&&"yes"===sessionStorage.getItem("adv_st_active")||(a.size=[[1540,1024],[300,600]])}catch(e){}},fnBeforeAdLeaderboard:function(e,a){IOL.adv.gdpr.consentGoogle||(a.setCollapseEmptyDiv="BEFORE_FETCH");IOL.adv.settings.classname;try{"undefined"!=pubAdsCfg.location&&(a.adUnitPath=a.adUnitPath.concat("/"+pubAdsCfg.location))}catch(e){}},fnBeforeAdMpu:function(e,a){IOL.adv.gdpr.consentGoogle||(a.setCollapseEmptyDiv="BEFORE_FETCH");IOL.adv.settings.classname;try{"undefined"!=pubAdsCfg.location&&(a.adUnitPath=a.adUnitPath.concat("/"+pubAdsCfg.location))}catch(e){}}},IOL.adv.settings.prebidjs={adUnits:[{code:"adsplash",mediaTypes:{banner:{sizeConfig:[{minViewPort:[0,0],sizes:[]},{minViewPort:[993,0],sizes:[[300,600]]}]}},bids:[{bidder:"criteo",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{networkId:1994,publisherSubId:"virgilio.webmail70_Desktop_login_300x600",pubid:"100725"}},{bidder:"cwire",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{domainId:663,placementId:280097643}},{bidder:"smartadserver",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{siteId:679604,pageId:2026164,formatId:108378}},{bidder:"appnexus",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{placementId:34152202}},{bidder:"pubmatic",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{publisherId:"83172",adSlot:"6276888"}},{bidder:"rubicon",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{accountId:11334,siteId:163726,zoneId:3572328}},{bidder:"onetag",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{pubId:"389a1a1c29",ext:{placement_name:"virgilio.webmail70_Desktop_login_300x600"}}},{bidder:"improvedigital",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{placementId:23277242,publisherId:946}},{bidder:"ix",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{siteId:"1139893",size:[300,600]}},{bidder:"nexx360",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[993,0],relevantMediaTypes:["banner"]}],params:{account:"1123",tagId:"d3p3k7rm",allBids:!1}}]},{code:"adleaderboard",mediaTypes:{banner:{sizeConfig:[{minViewPort:[0,0],sizes:[]},{minViewPort:[731,0],sizes:[[728,90]]}]}},bids:[{bidder:"criteo",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{networkId:1994,publisherSubId:"virgilio.webmail70_Desktop_login_728x90",pubid:"100725"}},{bidder:"cwire",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{domainId:663,placementId:280097644}},{bidder:"smartadserver",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{siteId:679604,pageId:2026164,formatId:108376}},{bidder:"appnexus",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{placementId:34152204}},{bidder:"pubmatic",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{publisherId:"83172",adSlot:"6276889"}},{bidder:"rubicon",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{accountId:11334,siteId:163726,zoneId:3572332}},{bidder:"onetag",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{pubId:"389a1a1c29",ext:{placement_name:"virgilio.webmail70_Desktop_login_728x90"}}},{bidder:"improvedigital",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{placementId:23277245,publisherId:946}},{bidder:"ix",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{siteId:"1139894",size:[728,90]}},{bidder:"nexx360",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[731,0],relevantMediaTypes:["banner"]}],params:{account:"1123",tagId:"txgg14ev",allBids:!1}}]},{code:"admpu",mediaTypes:{banner:{sizeConfig:[{minViewPort:[0,0],sizes:[]},{minViewPort:[320,0],sizes:[[300,250]]}]}},bids:[{bidder:"criteo",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[320,0],relevantMediaTypes:["banner"]}],params:{networkId:1994,publisherSubId:"virgilio.webmail70_Mobile_login_300x250",pubid:"100725"}},{bidder:"nexx360",sizeConfig:[{minViewPort:[0,0],relevantMediaTypes:["none"]},{minViewPort:[320,0],relevantMediaTypes:["banner"]}],params:{account:"1123",tagId:"q5b9rrl2",allBids:!1}}]}]},IOL.adv.manager={classname:"IOL.adv.manager",slotsContainer:[],refreshSlotsContainer:[],originalSlotsContainer:[],divIdAdsIdMap:{},lastSlotIdReady:"",videoAds:!1,customCriteria:{map:{},duration:""},init:function(e){let d=IOL.adv.manager.classname+".init";IOL.adv.tools.logger("Start function",d),IOL.adv.tools.initAds(),"function"!=typeof IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit||IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInitDone||(IOL.adv.tools.logger(`Run fnInit on slot: ${IOL.adv.pubAdsCfg.slot} using function: `+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit,d),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInitDone=!0,IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnInit()),Reflect.has(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot],"sliderContainer")&&"function"==typeof IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnInit&&(IOL.adv.tools.logger("Run fnInit on slot "+IOL.adv.pubAdsCfg.slot+" using function "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnInit,d),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnInit());var t=0;Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(e){var a=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e];a.divIdSwap&&(IOL.adv.tools.logger(e+" :: divIdSwap has been requested",d),IOL.adv.tools.divIdSwap(IOL.adv.pageWidth,a,e)),IOL.adv.manager.divIdAdsIdMap[a.divId]=e,a.divIdReady||"display"!=a.mediaType||(a.divIdReady=IOL.adv.tools.divIdReady(a),a.divIdReady?IOL.adv.tools.logger(a.divId+" is ready :: config :: "+JSON.stringify(a),d):a.optional?(IOL.adv.tools.logger(a.divId+" is not ready, ads is optional, disable ads",d,"warning"),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].mediaType="disabledDivIdNotReady",IOL.adv.settings.hasOwnProperty("prebidjs")&&IOL.adv.settings.prebidjs.hasOwnProperty("adUnits")&&(IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.rmAdunitByCode,{code:a.divId}))):IOL.adv.tools.logger(a.divId+" is not ready, ads is not optional",d,"warning")),"display"!=a.mediaType&&"video"!=a.mediaType||(t++,"function"!=typeof a.fnBefore||a.fnBeforeDone||(IOL.adv.tools.logger("Start fnBefore for "+e,d),a.fnBeforeDone=!0,a.fnBefore(e,a)),a.adUnitPath=IOL.adv.getAdUnitPath(e,!1,d))}),IOL.adv.tools.logger("number of defined ads:"+t,d),0==t?(IOL.adv.complete=!0,IOL.adv.tools.logger("IAM complete",d)):e(),IOL.adv.tools.asHandler("tagger")},run:function(){let o=IOL.adv.manager.classname+".run";IOL.adv.tools.logger("Start function. ",o),IOL.adv.pubAdsCfg.lazy=!(!IOL.adv.pubAdsCfg.lazy||"function"!=typeof IntersectionObserver||void 0===IOL.adv.settings.lazy),IOL.adv.pubAdsCfg.lazy&&(IOL.adv.tools.logger("Lazy enable, init IntersectionObserver",o),IOL.adv.settings.lazy.observer.obj=new IntersectionObserver(function(e){for(var a=e.length,d=0;d<a;d++){var t=e[d];IOL.adv.tools.logger("IntersectionObserver: div: "+t.target.id+", ratio: "+t.intersectionRatio,o),0<t.intersectionRatio&&(IOL.adv.tools.logger("IntersectionObserver: "+t.target.id+" is visible, remove observer, display ads",o),IOL.adv.settings.lazy.observer.obj.unobserve(document.getElementById(t.target.id)),t=IOL.adv.settings.lazy.divIdSlotIdMap[t.target.id],IOL.adv.tools.displayAds({slotId:t,changeCorrelator:!1}))}},IOL.adv.settings.lazy.observer.options));var e={};Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(a){var d=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[a];if(("display"==d.mediaType||"video"==d.mediaType)&&(e[a]=d).staticBanner){IOL.adv.tools.logger(d.divId+": staticBanner found",o);let e=!(IOL.adv.pubAdsCfg.deferredDisplay||"asFirst"!=d.staticBanner.mode&&IOL.adv.headerBidding.enable);IOL.adv.tools.displayStaticBanner(d,"asFirst",function(){return"function"==typeof d.staticBanner.condition?d.staticBanner.condition(d,e):e},function(){IOL.adv.tools.logger(a+": disable hb, use staticBanner for this ads",o),d.bidAmazon=!1,IOL.adv.settings.prebidjs.adUnits=IOL.adv.settings.prebidjs.adUnits.filter(IOL.adv.headerBidding.rmAdunitByCode,{code:d.divId})},o)}}),googletag.cmd.push(function(){IOL.adv.tools.logger("run gpt setup",o);var t=!1;IOL.adv.tools.logger("run gpt setConfig: singleRequest enabled",o),googletag.setConfig({singleRequest:!0}),Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).filter(function(e){if("display"==IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e].mediaType)return!0}).forEach(function(e){IOL.adv.tools.logger("Start manage ads "+e,o);let a=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e];if(IOL.adv.tools.logger(`run gpt defineSlot for ads ${a.id}, ads container `+a.divId,o),IOL.adv.pubAdsCfg.lazy&&!1!==a.lazy&&(a.setCollapseEmptyDiv="DISABLED"),a.onRenderEnded&&!IOL.adv.pubAdsCfg.deferredRun)try{a.onRenderEnded.forEach(function(e){IOL.adv.tools.logger(a.divId+" :: found onRenderEnded",o),e.condition=e.condition||"default","function"!=typeof e.allowedSizes&&(e.allowedSizes=e.allowedSizes?Array.isArray(e.allowedSizes)?e.allowedSizes:Array(e.allowedSizes):[]),IOL.adv.tools.onRenderEnded(a,e)})}catch(e){}var d;IOL.adv.manager.lastSlotIdReady=e,a.outOfPage?a.interstitial?(IOL.adv.manager.slotsContainer[e]=googletag.defineOutOfPageSlot(a.adUnitPath.trim(),googletag.enums.OutOfPageFormat.INTERSTITIAL),IOL.adv.manager.slotsContainer[e]?(IOL.adv.manager.slotsContainer[e].addService(googletag.pubads()),IOL.adv.tools.logger("interstitial supported for "+e,o)):IOL.adv.tools.logger("interstitial not supported for "+e,o)):IOL.adv.manager.slotsContainer[e]=googletag.defineOutOfPageSlot(a.adUnitPath.trim(),a.divId).addService(googletag.pubads()):IOL.adv.manager.slotsContainer[e]=googletag.defineSlot(a.adUnitPath.trim(),a.size,a.divId).addService(googletag.pubads()),a.customCriteria&&(IOL.adv.tools.logger(a.divId+" :: found slot level customCriteria :: "+JSON.stringify(a.customCriteria),o),IOL.adv.tools.setTargeting(IOL.adv.manager.slotsContainer[e],a.customCriteria)),a.companionVideo&&(IOL.adv.tools.logger(`Ads settings of ${e} :: companionVideo: `+a.companionVideo,o),t=!0,IOL.adv.manager.slotsContainer[e].addService(googletag.companionAds())),IOL.adv.manager.slotsContainer[e].setConfig({collapseDiv:a.setCollapseEmptyDiv||"DISABLED"}),a.sizeMapping&&(IOL.adv.tools.logger("Start define sizeMapping for "+e,o),d=googletag.sizeMapping(),Object.keys(a.sizeMapping).forEach(function(e){IOL.adv.tools.logger(a.divId+" enable sizeMapping for dimension: "+e+" with size: "+a.sizeMapping[e][0]+" :: "+a.sizeMapping[e][1],o),d.addSize(a.sizeMapping[e][0],a.sizeMapping[e][1])}),d)&&IOL.adv.manager.slotsContainer[e].defineSizeMapping(d.build()),a.forceSafeFrame&&(IOL.adv.manager.slotsContainer[e].setConfig({safeFrame:{forceSafeFrame:!0}}),IOL.adv.tools.logger("run gpt setConfig: safeFrame enabled for "+e,o)),"function"!=typeof a.fnAfter||a.fnAfterDone||(IOL.adv.tools.logger("Start fnAfter for "+e,o),a.fnAfterDone=!0,a.fnAfter(e,a))}),t&&(IOL.adv.tools.logger("companionVideo enabled, run gpt setConfig setRefreshUnfilledSlots and enableVideoAds",o),googletag.companionAds().setRefreshUnfilledSlots(!1),googletag.setConfig({videoAds:{enableVideoAds:!0}})),IOL.adv.tools.logger("run gpt setConfig enableServices",o),googletag.enableServices(),"function"==typeof IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnFinally&&(IOL.adv.tools.logger("Run fnFinally on slot: "+IOL.adv.pubAdsCfg.slot+" using function: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnFinally,o),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].fnFinally()),Reflect.has(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot],"sliderContainer")&&"function"==typeof IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnFinally&&(IOL.adv.tools.logger("Run fnFinally on slot: "+IOL.adv.pubAdsCfg.slot+" using function: "+IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnFinally,o),IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].sliderContainer.fnFinally()),IOL.adv.pubAdsCfg.deferredRun&&(IOL.adv.complete=!0,IOL.adv.tools.logger("IAM complete",o));"standard"==IOL.adv.mode&&(IOL.adv.tools.logger("Event slotResponseReceived added, mode is standard",o),googletag.pubads().addEventListener("slotResponseReceived",e=>{var a=IOL.adv.manager.classname+".slotResponseReceived";let d=!1,t=e.slot.getSlotElementId(),o;document.getElementById(t)?d=!0:e.slot.getOutOfPage()&&(o=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[IOL.adv.manager.divIdAdsIdMap[t.replace(/^gpt_unit_|_[0-9]$/g,"")]].divId,IOL.adv.tools.logger(`${t} is outOfPage. Try to find the real ads container id using ${t.replace(/^gpt_unit_|_[0-9]$/g,"")}, ads container found: `+o,a),o)&&document.getElementById(o)&&(d=!0,t=o),d?IOL.adv.tools.logger(t+": ads container is ready",a):(IOL.adv.tools.logger(t+": ads container is not ready",a,"warning"),IOL.adv.tools.trkPerf("iamErrorAdsContainerNotReady",Math.floor(performance.now()),[t],!0))}),IOL.adv.tools.logger("Event slotRenderEnded added, mode is standard",o),googletag.pubads().addEventListener("slotRenderEnded",e=>{var a=IOL.adv.manager.classname+".slotRenderEnded",d=e.slot.getSlotElementId();IOL.adv.tools.logger(d+" :: slotRenderEnded received, ads is "+(e.isEmpty?"empty":"filled"),a),IOL.adv.tools.trkPerf("iamRenderingEnd",Math.floor(performance.now()),!0),"function"==typeof IamCallbackSlotRenderEnded&&(IOL.adv.tools.logger("Hook IamCallbackSlotRenderEnded for "+e.slot.getSlotElementId(),a),IamCallbackSlotRenderEnded())})),IOL.adv.tools.logger("End function. ",o)}),IOL.adv.pubAdsCfg.deferredRun||IOL.adv.settings.deferredHeaderBidding||IOL.adv.headerBidding.init(e,function(){IOL.adv.headerBidding.enable?IOL.adv.headerBidding.run():googletag.cmd.push(()=>{IOL.adv.pubAdsCfg.lazy?(IOL.adv.tools.logger("Start Lazy loading in standard mode",o),Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(e){var a,d=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e];"display"==d.mediaType&&(0==d.lazy?(IOL.adv.tools.logger(d.divId+", lazy disable for this ads, start display",o),IOL.adv.tools.displayAds({slotId:e,changeCorrelator:!1})):(IOL.adv.tools.logger(d.divId+", lazy enabled for this ads, start intersectionObserver",o),(a=IOL.adv.tools.divIdReady(d,!0))&&(IOL.adv.settings.lazy.observer.obj.observe(a),IOL.adv.settings.lazy.divIdSlotIdMap[d.divId]=e)))})):(IOL.adv.tools.logger("Ads start displayAds in standard mode for slot: "+IOL.adv.pubAdsCfg.slot,o),IOL.adv.tools.displayAds());try{"function"==typeof IamCallbackOnComplete&&(IOL.adv.tools.logger("Hook IamCallbackOnComplete. HeaderBidding is disable",o),IamCallbackOnComplete())}catch(e){}})}),IOL.adv.tools.injectPlayer()},setCustomCriteria:function(){let t=IOL.adv.manager.classname+".setCustomCriteria";IOL.adv.tools.logger("Start function",t);IOL.adv.getConsentString();var a={oe:{condition:"string"==typeof document.characterSet,value:document.characterSet,otherwise:"UTF-8"},optout:{condition:IOL.adv.profile.enable,value:"0",otherwise:"1"},adv_infocus:{condition:IOL.adv.hasFocus,value:"yes",otherwise:"no"},adv_np:{condition:IOL.adv.cookie.get("ADV_NP"),value:"yes"},adv_topics:{condition:0<IOL.adv.topics.length,value:IOL.adv.topics},inventory_type:{condition:!0,value:"browsable"},adv_referrer:{condition:!0,value:IOL.adv.referrerLabel},adv_sgt:{condition:!0,value:IOL.adv.tools.randomInt(1,4)},pbjs_version:{condition:IOL.adv.headerBidding.prebidjs.enable,value:IOL.adv.headerBidding.prebidjs.version},native:{condition:!1!==IOL.adv.pubAdsCfg.native,value:IOL.adv.pubAdsCfg.native},is_native:{condition:!1!==IOL.adv.pubAdsCfg.native,value:""!==IOL.adv.pubAdsCfg.native?"yes":"no",otherwise:"no"},"1plusx":{condition:IOL.adv.profile.as.enable&&!IOL.adv.profile.up.value.isMinor&&0<IOL.adv.profile.as.value.s.length,value:IOL.adv.profile.as.value.s},ctx1plusx:{condition:0<IOL.adv.profile.as.value.t.length,value:IOL.adv.profile.as.value.t},sda528:{condition:IOL.adv.profile.as.enable&&!IOL.adv.profile.up.value.isMinor&&Boolean(IOL.adv.profile.as.value.sda[528]&&0<IOL.adv.profile.as.value.sda[528].length),value:IOL.adv.profile.as.value.sda[528]||""},xdid_user:{condition:IOL.adv.getProfile("ppid.iol"),value:"true"},adv_sso1:{condition:IOL.adv.profile.enable&&IOL.adv.profile.up.value.age,value:IOL.adv.profile.up.value.age,otherwise:"0"},adv_sso2:{condition:IOL.adv.profile.enable&&IOL.adv.profile.up.value.gender,value:IOL.adv.profile.up.value.gender,otherwise:"0"},adv_sso3:{condition:IOL.adv.profile.enable&&IOL.adv.profile.up.value.province,value:IOL.adv.profile.up.value.province,otherwise:"0"},seat_keyword:{condition:IOL.adv.profile.enable&&IOL.adv.profile.up.value.ext.seat_keyword,value:IOL.adv.profile.up.value.ext.seat_keyword},us_ua:{condition:IOL.adv.profile.up.value.isMinor,value:"true",otherwise:"false"},kw_test:{condition:null!==IOL.adv.tools.getParameterByName("kw_test"),value:IOL.adv.tools.getParameterByName("kw_test")},siz_hostname:{condition:!0,value:IOL.adv.hostname},siz_devicetype:{condition:!0,value:IOL.adv.device},downlink:{condition:"number"==typeof IOL.adv.downlink,value:IOL.adv.downlink}};IOL.adv.pubAdsCfg.customCriteria&&Object.keys(IOL.adv.pubAdsCfg.customCriteria).forEach(function(e){IOL.adv.tools.logger("Manage client customCriteria: "+e+" value:"+IOL.adv.pubAdsCfg.customCriteria[e],t),""!==IOL.adv.pubAdsCfg.customCriteria[e]&&(a[e]={condition:!1,value:!1},a[e].condition=!0,a[e].value=String(IOL.adv.pubAdsCfg.customCriteria[e]).replace(/\|/g,","))}),IOL.adv.manager.customCriteria.map=IOL.adv.tools.extend(IOL.adv.manager.customCriteria.map,a),IOL.adv.profile.up.value.isMinor&&(delete IOL.adv.manager.customCriteria.map.adv_sso1,delete IOL.adv.manager.customCriteria.map.adv_sso2,delete IOL.adv.manager.customCriteria.map.adv_sso3),Object.keys(IOL.adv.manager.customCriteria.map).forEach(function(e){var a,d;IOL.adv.tools.logger("Manage Target: "+e+" :: condition: "+IOL.adv.manager.customCriteria.map[e].condition+" :: value: "+IOL.adv.manager.customCriteria.map[e].value+" :: otherwise: "+IOL.adv.manager.customCriteria.map[e].otherwise,t),IOL.adv.manager.customCriteria.map[e].condition&&void 0!==IOL.adv.manager.customCriteria.map[e].value?(d=String(IOL.adv.manager.customCriteria.map[e].value),IOL.adv.tools.logger("Condition is true for Target: "+e+" :: assign value: "+d,t),(a={})[e]=d,IOL.adv.tools.setTargeting(!1,a)):IOL.adv.manager.customCriteria.map[e].otherwise?((d={})[e]=IOL.adv.manager.customCriteria.map[e].otherwise,IOL.adv.tools.setTargeting(!1,d),IOL.adv.tools.logger("Condition is false, otherwise is configured for Target: "+e+" :: assign value: "+IOL.adv.manager.customCriteria.map[e].otherwise,t)):IOL.adv.tools.logger("Condition is false, otherwise is not configured for Target: "+e+", custom criteria has not been set",t)}),IOL.adv.tools.logger("end function",t)},createAds:function(e,a){var d=IOL.adv.manager.classname+".createAds",a=(IOL.adv.tools.logger("Start function",d),a||0);try{var t,o=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].dynamic||{enable:!1};o.enable&&e&&((t=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads)[e]={},t[e].id=e,t[e].divId=e,t[e].adUnitPath=""+o.adUnitPath+(o.customSepator||"/")+(a+1),t[e].size=o.size,t[e].sizeMapping=o.sizeMapping||!1,t[e].mediaType="display",t[e].optional=!0,t[e].sizeIsCompliant=!0,t[e].forceSafeFrame=!1,o.staticBanner&&(t[e].staticBanner=Object.assign({},o.staticBanner),t[e].staticBanner.html)&&(t[e].staticBanner.html=t[e].staticBanner.html.replace("%IDX%",adUnitPathSuffix)),o.hasOwnProperty("onRenderEnded")&&(t[e].onRenderEnded=o.onRenderEnded),t[e].customCriteria=o.customCriteria||!1,t[e].bidAmazon=!0,t[e].refresh=o.refresh||{autorefresh:!1,initialized:!1,ts:!1,gap:3e3,counter:0},t[e].fnBefore=o.fnBefore||!1,t[e].fnAfter=o.fnAfter||!1,IOL.adv.tools.logger(`Create dynamic ads with id: ${e}, idx: `+a,d),IOL.adv.headerBidding.enable&&IOL.adv.settings.prebidjs.dynamicAdUnits?IOL.adv.settings.prebidjs.dynamicAdUnits[a]?(IOL.adv.settings.prebidjs.dynamicAdUnits[a].code=t[e].divId,IOL.adv.settings.prebidjs.adUnits.push(Object.assign({},IOL.adv.settings.prebidjs.dynamicAdUnits[a])),IOL.adv.tools.logger("Prebid adUnit code found for ads: "+e,d)):IOL.adv.tools.logger("Prebid adUnit code not found for ads: "+e,d):IOL.adv.tools.logger("Prebid disabled for ads: "+e,d),IOL.adv.tools.logger("End function",d))}catch(e){}}},IOL.adv.headerBidding={classname:"IOL.adv.headerBidding",enable:!0,bids:!1,pipeline:"display",hbTimeout:1e3,bidderTimeout:750,supplyChainSid:!1,bidders:[],pbjsHybrid:{display:["appnexus","criteo","rubicon","ogury","nexx360"],native:["appnexus","criteo","nexx360"],videoInstream:["appnexus","criteo","nexx360"],videoOutstream:["teads"],condition:function(){return"mobile"==IOL.adv.tools.getDevice()}},requestManager:{adServerRequestSent:!1,timer:!1,timedOut:!1},amazon:{id:"amazon",enable:!1,init:!1,pubID:"3204",adServer:"googletag",deals:!0,videoAdServer:"DFP",excludeSizes:[[1,1],[320,100],[336,250],[336,280],[728,1],[970,270]],slots:[],bids:!1,videoBid:""},prebidjs:{id:"prebidjs",version:"0",enable:!1,adUnits:[],bids:!1,useBidCache:!0,customConfigObject:{buckets:[{precision:2,max:3,increment:.01},{precision:2,max:8,increment:.05},{precision:2,max:20,increment:.5},{precision:2,max:30,increment:1}]},customSizeConfig:[{mediaQuery:"(min-width: 1025px)",sizesSupported:[[1800,1e3],[1200,90],[970,250],[970,90],[728,90],[640,480],[300,250],[300,600],[100,200],[1,1]],labels:["desktop"]},{mediaQuery:"(min-width: 766px) and (max-width: 1024px)",sizesSupported:[[728,90],[640,480],[300,250],[300,600],[100,200],[1,1]],labels:["tablet"]},{mediaQuery:"(min-width: 320px) and (max-width: 765px)",sizesSupported:[[640,300],[640,480],[300,250],[300,600],[300,50],[320,50],[320,100],[100,200],[1,1]],labels:["mobile"]}]},init:function(i,n){let s=IOL.adv.headerBidding.classname+".init";IOL.adv.tools.logger("Start function",s),IOL.adv.headerBidding.enable=!1,IOL.adv.headerBidding.bidders=[],IOL.adv.headerBidding.amazon.enable=!1,IOL.adv.headerBidding.amazon.slots=[],IOL.adv.headerBidding.amazon.bids=!1,IOL.adv.headerBidding.amazon.videoBid="",IOL.adv.headerBidding.prebidjs.enable=!1,IOL.adv.headerBidding.prebidjs.adUnits=[],IOL.adv.headerBidding.prebidjs.bids=!1,IOL.adv.headerBidding.prebidjs.useBidCache=!Reflect.has(IOL.adv.settings,"useBidCache")||IOL.adv.settings.useBidCache,IOL.adv.headerBidding.requestManager={adServerRequestSent:!1,timedOut:!1},IOL.adv.pubAdsCfg.prebid&&IOL.adv.gdpr.enable&&!IOL.adv.profile.up.value.isMinor&&!!IOL.adv.settings.library.prebid&&IOL.adv.settings.library.prebid.enable?(IOL.adv.headerBidding.hbTimeout=IOL.adv.settings.hbTimeout||IOL.adv.headerBidding.hbTimeout,IOL.adv.headerBidding.bidderTimeout=IOL.adv.settings.bidderTimeout||IOL.adv.headerBidding.bidderTimeout,IOL.adv.tools.logger((IOL.adv.settings.hbTimeout||IOL.adv.settings.bidderTimeout?"timeout override ":"use default ")+"hbTimeout: "+IOL.adv.headerBidding.hbTimeout+", bidderTimeout: "+IOL.adv.headerBidding.bidderTimeout,s),1==Object.keys(i).length&&(i.advideo?IOL.adv.headerBidding.pipeline="video":IOL.adv.headerBidding.pipeline="display"),IOL.adv.tools.logger("HeaderBidding, start compliance check for Amazon.",s),"undefined"!=typeof apstag&&IOL.adv.gdpr.consentString?(Object.keys(i).forEach(function(e){var a,d,t=i[e],o=[];t.size&&(o=t.size.filter(IOL.adv.tools.filterArrayInArray,{list:IOL.adv.headerBidding.amazon.excludeSizes})),IOL.adv.tools.logger("HeaderBidding Amazon for "+e+" :: ad.bidAmazon:"+t.bidAmazon+", ad.mediaType:"+t.mediaType+", ad.sizeIsCompliant:"+t.sizeIsCompliant+", ad.divIdReady:"+t.divIdReady+", sizes:"+o,s),t.bidAmazon&&t.sizeIsCompliant&&t.divIdReady&&0<o.length?(IOL.adv.tools.logger("HeaderBidding Amazon enable for "+e,s),"display"==t.mediaType&&"multi-format"==t.bidAmazon&&t.hasOwnProperty("bidAmazonMultiFormatProperties")&&(a=!0,t.bidAmazonMultiFormatProperties.hasOwnProperty("condition")&&"function"==typeof t.bidAmazonMultiFormatProperties.condition&&(a=t.bidAmazonMultiFormatProperties.condition()),d=t.bidAmazonMultiFormatProperties.hasOwnProperty("multiFormatProperties")?t.bidAmazonMultiFormatProperties.multiFormatProperties:t.bidAmazonMultiFormatProperties,IOL.adv.tools.logger("condition "+a+" on "+e+" for HeaderBidding Amazon multi-format",s),a?IOL.adv.headerBidding.amazon.slots.push({slotID:t.divId,slotName:t.adUnitPath,mediaType:"multi-format",multiFormatProperties:d}):(o=d.display.sizes.filter(IOL.adv.tools.filterArrayInArray,{list:IOL.adv.headerBidding.amazon.excludeSizes}),t.bidAmazon=!0)),"display"==t.mediaType&&1==t.bidAmazon&&(IOL.adv.tools.logger("HeaderBidding Amazon add display slot "+e,s),IOL.adv.headerBidding.amazon.slots.push({slotID:t.divId,slotName:t.adUnitPath,sizes:o})),"display"==t.mediaType&&"outstream"==t.bidAmazon&&(IOL.adv.tools.logger("HeaderBidding Amazon add outstream slot "+e,s),IOL.adv.headerBidding.amazon.slots.push({slotID:t.divId,mediaType:"video"})),"video"==t.mediaType&&(IOL.adv.tools.logger("HeaderBidding Amazon add video slot "+e,s),IOL.adv.headerBidding.amazon.slots.push({slotID:"videoSlot",mediaType:"video"}))):IOL.adv.tools.logger("HeaderBidding Amazon disable for "+e,s)}),0<IOL.adv.headerBidding.amazon.slots.length&&(IOL.adv.headerBidding.amazon.enable=!0,IOL.adv.headerBidding.bidders.push(IOL.adv.headerBidding.amazon.id),IOL.adv.headerBidding.apstagInit(),IOL.adv.tools.logger("HeaderBidding Amazon slots "+JSON.stringify(IOL.adv.headerBidding.amazon.slots),s),IOL.adv.tools.logger("HeaderBidding Amazon compliant and initialized.",s))):IOL.adv.tools.logger("HeaderBidding Amazon: apstag is not defined or consentString is false",s),IOL.adv.tools.logger("HeaderBidding Amazon enable: "+IOL.adv.headerBidding.amazon.enable,s),IOL.adv.tools.logger("HeaderBidding, start compliance check for prebidjs.",s),Object.keys(i).forEach(function(e){IOL.adv.settings.prebidjs.adUnits.filter(function(e){if(e.code==this.code)return IOL.adv.headerBidding.prebidjs.adUnits.push(e),!0},{code:i[e].divId}),i[e].interstitial&&(IOL.adv.tools.logger(`HeaderBidding, ${e} is interstitial, replace adUnit code with `+i[e].adUnitPath,s),IOL.adv.settings.prebidjs.adUnits.find(IOL.adv.headerBidding.replaceAdunitByCode,{code:e,newcode:i[e].adUnitPath}),IOL.adv.manager.divIdAdsIdMap[i[e].adUnitPath]=e)}),window.pbjs.que.push(function(){var d,t,o,e,a;IOL.adv.tools.logger("HeaderBidding, prebidjs adUnits length: "+IOL.adv.headerBidding.prebidjs.adUnits.length,s),0<IOL.adv.headerBidding.prebidjs.adUnits.length?(IOL.adv.headerBidding.prebidjs.version=pbjs.version,IOL.adv.headerBidding.prebidjs.enable=!0,IOL.adv.headerBidding.bidders.push(IOL.adv.headerBidding.prebidjs.id),d={keyValues:{adv_sso1:[IOL.adv.profile.enable&&IOL.adv.profile.up.value.age||"0"],adv_sso2:[IOL.adv.profile.enable&&IOL.adv.profile.up.value.gender||"0"]}},t={keywords:{"1plusx":IOL.adv.profile.as.enable?IOL.adv.profile.as.value.s:[],ctx1plusx:IOL.adv.profile.as.value.t}},IOL.adv.headerBidding.pbjsHybrid=(IOL.adv.settings.hasOwnProperty("pbjsHybrid")?IOL.adv.settings:IOL.adv.headerBidding).pbjsHybrid,o=IOL.adv.tools.pbjsHybridCondition(),IOL.adv.headerBidding.prebidjs.adUnits.forEach(function(a){a.bids.find(IOL.adv.headerBidding.addObjOnBidderParams,{bidder:"improvedigital",kv:d}),a.bids.find(IOL.adv.headerBidding.addObjOnBidderParams,{bidder:"appnexus",kv:t}),o&&IOL.adv.tools.filteringPbjsHybrid(a);try{a.mediaTypes.hasOwnProperty("video")&&"outstream"===a.mediaTypes.video.context&&(a.mediaTypes.video.hasOwnProperty("plcmt")||(a.mediaTypes.video.plcmt=4),a.mediaTypes.video.hasOwnProperty("playbackmethod")||(a.mediaTypes.video.playbackmethod=[6]),IOL.adv.tools.logger("video outstream found for "+a.code+", add plcmt: "+a.mediaTypes.video.plcmt+", add playbackmethod: ["+a.mediaTypes.video.playbackmethod+"]",s)),a.mediaTypes.hasOwnProperty("video")&&"instream"===a.mediaTypes.video.context&&(a.mediaTypes.video.hasOwnProperty("plcmt")||(a.mediaTypes.video.plcmt=IOL.adv.pubAdsCfg.customCriteria.adv_playertv||IOL.adv.pubAdsCfg.customCriteria.adv_playerincontent?2:1),a.mediaTypes.video.hasOwnProperty("playbackmethod")||(a.mediaTypes.video.playbackmethod=IOL.adv.pubAdsCfg.customCriteria.adv_playertv||IOL.adv.pubAdsCfg.customCriteria.adv_playerincontent?[5]:[1]),IOL.adv.tools.logger("video outstream found for "+a.code+", add plcmt: "+a.mediaTypes.video.plcmt+", add playbackmethod: ["+a.mediaTypes.video.playbackmethod+"]",s))}catch(e){IOL.adv.tools.logger("something went wrong applying video plcmt: "+a.code,s,"error")}try{var e;a.hasOwnProperty("ortb2Imp")||(e=a.mediaTypes.hasOwnProperty("video")&&"instream"===a.mediaTypes.video.context?IOL.adv.videoAds.adUnitPath||IOL.adv.getAdUnitPath("advideo",!1,s):IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[IOL.adv.manager.divIdAdsIdMap[a.code]].adUnitPath,a.ortb2Imp={ext:{gpid:e}},IOL.adv.tools.logger("add gpid on: "+a.code+" using: "+e,s))}catch(e){IOL.adv.tools.logger("something went wrong applying gpid on: "+a.code,s,"error")}}),pbjs.bidderSettings={pubmatic:{adserverTargeting:[{key:"hb_bidder_pubmatic",val:function(e){return e.bidderCode}},{key:"hb_adid_pubmatic",val:function(e){return e.adId}},{key:"hb_deal_pubmatic",val:function(e){return e.dealId}},{key:"hb_pb_pubmatic",val:function(e){return e.pbMg}}]}},e=!!IOL.adv.profile.enable&&(IOL.adv.pubAdsCfg.ppid||(IOL.adv.getProfile("ppid.zeo")?IOL.adv.getProfile("ppid.zeo"):!!IOL.adv.getProfile("ppid.fallback")&&IOL.adv.getProfile("ppid.fallback"))),IOL.adv.tools.logger("apply ppid "+e,s),e&&pbjs.setBidderConfig({bidders:["criteo"],config:{ortb2:{user:{ext:{data:{eids:[{source:IOL.adv.hostname,uids:[{id:e,atype:3,ext:{stype:"hemsha256"}}]}]}}}}}}),pbjs.bidderSettings=pbjs.bidderSettings||{},pbjs.bidderSettings.standard=pbjs.bidderSettings.standard||{},pbjs.bidderSettings.standard.storageAllowed=IOL.adv.deviceAccess.enable,IOL.adv.tools.logger("HeaderBidding prebidjs, Start pbjs.que.push",s),e={},IOL.adv.gdpr.enable&&(IOL.adv.tools.logger("apply GDPR TCF v2.0",s),e={gdpr:{cmpApi:"iab",timeout:2e3,defaultGdprScope:!0}},"static"==IOL.adv.gdpr.tcfv20.pipeline.cmpApi)&&(IOL.adv.tools.logger("method is static, consentData: "+IOL.adv.gdpr.consentString,s),e={gdpr:{cmpApi:"static",consentData:{getTCData:{tcString:IOL.adv.gdpr.consentString,gdprApplies:!0}}}}),pbjs.setConfig({cpmRoundingFunction:Math.round}),IOL.adv.headerBidding.supplyChainSid&&pbjs.setConfig({schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:"italiaonline.it",sid:IOL.adv.headerBidding.supplyChainSid,hp:1}]}}}),a=[{provider:"id5Analytics",options:{partnerId:522}}],IOL.adv.tools.mEnable("liveramp")&&IOL.adv.settings.modules.liveramp.atsAnalytics&&a.push({provider:"atsAnalytics",options:{pid:"1274"}}),pbjs.enableAnalytics(a),a=[],IOL.adv.deviceAccess.enable&&(a=[{name:"id5Id",params:{partner:522,pd:"",abTesting:{enabled:!0,controlGroupPct:.15}},storage:{type:"html5",name:"id5id",expires:90,refreshInSeconds:28800}},{name:"identityLink",params:{pid:"1274"},storage:{type:"html5",name:"idl_env",expires:90,refreshInSeconds:1800}},{name:"sharedId",storage:{name:"_pubcid",type:"html5",expires:30}},{name:"pairId",params:{liveramp:{}}},{name:"tncId",params:{url:"https://js.tncid.app/remote.min.js?providerId=10e652c5-8543-48f1-af62-31f6e635baa1"}},{name:"criteo"}],pbjs.installedModules.includes("unifiedIdSystem"))&&(pbjs.setConfig({enableTIDs:!0}),a.push({name:"unifiedId",params:{partner:"qvj0nc1"},storage:{type:"html5",name:"pbjs-unifiedid",expires:60}})),pbjs.setConfig({enableSendAllBids:!1,useBidCache:IOL.adv.headerBidding.prebidjs.useBidCache,targetingControls:{alwaysIncludeDeals:!0,addTargetingKeys:["SOURCE","CACHE_ID","ADOMAIN"]},priceGranularity:IOL.adv.headerBidding.prebidjs.customConfigObject,currency:{adServerCurrency:"USD",defaultRates:{USD:{EUR:.9195}}},sizeConfig:IOL.adv.headerBidding.prebidjs.customSizeConfig,deviceAccess:IOL.adv.deviceAccess.enable,userSync:{syncEnabled:IOL.adv.deviceAccess.enable,filterSettings:{iframe:{bidders:"*",filter:"include"}},userIds:a,syncDelay:3e3,auctionDelay:0,topics:{maxTopicCaller:1,bidders:[{bidder:"pubmatic",iframeURL:"https://ads.pubmatic.com/AdServer/js/topics/topics_frame.html",expiry:7},{bidder:"openx",iframeURL:"https://pa.openx.net/topics_frame.html",expiry:7},{bidder:"onetag",iframeURL:"https://onetag-sys.com/static/topicsapi.html",expiry:7}]}},bidderTimeout:IOL.adv.headerBidding.bidderTimeout,rubicon:{singleRequest:!0},improvedigital:{usePrebidSizes:!0,singleRequest:!0},consentManagement:e,floors:{data:{currency:"EUR",schema:{fields:["mediaType","size"]},values:IOL.adv.settings.hasOwnProperty("floor")?IOL.adv.settings.floor:{"banner|*":.05,"native|*":.05,"video|*":1}}},cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},paapi:{enabled:!0,gpt:{autoconfig:!1,configWithTargeting:!1},defaultForSlots:1}}),pbjs.aliasBidder("smartadserver","smart"),pbjs.removeAdUnit(),IOL.adv.tools.logger("HeaderBidding prebidjs adUnits: "+JSON.stringify(IOL.adv.headerBidding.prebidjs.adUnits),s),pbjs.addAdUnits(IOL.adv.headerBidding.prebidjs.adUnits),IOL.adv.tools.logger("HeaderBidding prebidjs enable: "+IOL.adv.headerBidding.prebidjs.enable,s),IOL.adv.tools.logger("HeaderBidding prebidjs compliant and initialized.",s)):IOL.adv.tools.logger("HeaderBidding prebidjs: adUnits is empty",s),IOL.adv.headerBidding.bidders.forEach(function(e){IOL.adv.headerBidding.requestManager[e]=!1}),0<IOL.adv.headerBidding.bidders.length?(IOL.adv.headerBidding.enable=!0,googletag.cmd.push(()=>{IOL.adv.tools.logger("HeaderBidding enable, run gpt setConfig disableInitialLoad",s),googletag.setConfig({disableInitialLoad:!0})})):(IOL.adv.headerBidding.enable=!1,IOL.adv.tools.logger("HeaderBidding disabled",s)),n&&(IOL.adv.tools.logger("HeaderBidding run callback: "+n,s),n()),IOL.adv.tools.logger("End function",s)})):(IOL.adv.tools.logger("HeaderBidding disabled",s),n&&(IOL.adv.tools.logger("HeaderBidding run callback: "+n,s),n()))},run:function(e){var a=IOL.adv.headerBidding.classname+".run";IOL.adv.tools.logger("Start function",a),IOL.adv.headerBidding.enable?(IOL.adv.headerBidding.fetchBids(e),IOL.adv.headerBidding.requestManager.timer=window.setTimeout(function(){IOL.adv.headerBidding.sendAdserverRequest(function(){IOL.adv.headerBidding.adServerRequestTimedOut(e)})},IOL.adv.headerBidding.hbTimeout),IOL.adv.tools.logger("End function",a)):(IOL.adv.tools.logger("HeaderBidding disabled",a),e&&(IOL.adv.tools.logger("HeaderBidding run callback: "+e,a),e()))},fetchBids:function(a){let d=IOL.adv.headerBidding.classname+".fetchBids";IOL.adv.tools.trkPerf("iamHBStart",Math.floor(performance.now()),["hbStart"]),IOL.adv.headerBidding.amazon.enable?(IOL.adv.tools.logger("Start fetch bids for amazon.",d),IOL.adv.tools.trkPerf("iamHBamazonStart",Math.floor(performance.now()),["hbStart"]),apstag.fetchBids({slots:IOL.adv.headerBidding.amazon.slots,timeout:IOL.adv.headerBidding.bidderTimeout},function(e){IOL.adv.tools.logger("amazon response: "+JSON.stringify(e),d),IOL.adv.headerBidding.amazon.bids=e,IOL.adv.headerBidding.headerBidderBack(IOL.adv.headerBidding.amazon.id,a),IOL.adv.tools.trkPerf("iamHBamazonEnd",Math.floor(performance.now()),[IOL.adv.headerBidding.requestManager.timedOut?"hbTimedOut":"hbRunning"])})):IOL.adv.tools.logger("amazon is disable.",d),window.pbjs.que.push(function(){IOL.adv.headerBidding.prebidjs.enable?(pbjs.onEvent("bidRequested",function(e){IOL.adv.tools.trkPerf("iamHBprebidRequested",Math.floor(performance.now()),["hbStart"])}),IOL.adv.tools.trkPerf("iamHBprebidStart",Math.floor(performance.now()),["hbStart"]),pbjs.requestBids({bidsBackHandler:function(e){IOL.adv.tools.logger("pbjs response: "+JSON.stringify(e),d),IOL.adv.headerBidding.headerBidderBack(IOL.adv.headerBidding.prebidjs.id,a),IOL.adv.tools.trkPerf("iamHBprebidEnd",Math.floor(performance.now()),[IOL.adv.headerBidding.requestManager.timedOut?"hbTimedOut":"hbRunning"])},timeout:IOL.adv.headerBidding.bidderTimeout}),IOL.adv.tools.mEnable("trkPrebid")&&(pbjs.onEvent("bidResponse",e=>{IOL.adv.tools.trkPerf("iamHBprebidEnd"+e.bidderCode.capitalize(),Math.floor(performance.now()),[IOL.adv.headerBidding.requestManager.timedOut?"hbTimedOut":"hbRunning"])}),pbjs.onEvent("bidTimeout",e=>{e.forEach(e=>{IOL.adv.tools.trkPerf("iamHBprebidTimeout"+e.bidder.capitalize(),Math.floor(performance.now()),[IOL.adv.headerBidding.requestManager.timedOut?"hbTimedOut":"hbRunning"])})}))):IOL.adv.tools.logger("pbjs is disable.",d)})},adServerRequestTimedOut:function(e){var a=IOL.adv.headerBidding.classname+".adServerRequestTimedOut";!1!==IOL.adv.headerBidding.requestManager.timer&&(IOL.adv.headerBidding.requestManager.timedOut=!0,IOL.adv.tools.trkPerf("iamHBtimeout",Math.floor(performance.now()),["hbTimedOut"])),IOL.adv.tools.logger("requestManager.timedOut: "+IOL.adv.headerBidding.requestManager.timedOut,a)},sendAdserverRequest:function(e){let t=IOL.adv.headerBidding.classname+".sendAdserverRequest",a;IOL.adv.tools.logger("Start function",t),!0===IOL.adv.headerBidding.requestManager.adServerRequestSent?IOL.adv.tools.logger("Request has been already sent",t):(IOL.adv.headerBidding.requestManager.adServerRequestSent=!0,clearTimeout(IOL.adv.headerBidding.requestManager.timer),IOL.adv.tools.logger("Request has not been sent, start adServerRequest push",t),e&&(IOL.adv.tools.logger("Run callback: "+e,t),e()),IOL.adv.tools.trkPerf("iamHBend",Math.floor(performance.now()),[IOL.adv.headerBidding.requestManager.timedOut?"hbTimedOut":"hbSuccess"]),IOL.adv.headerBidding.amazon.enable&&IOL.adv.headerBidding.amazon.bids&&0<(a=IOL.adv.headerBidding.amazon.bids.filter(function(e){return"video"===e.mediaType})).length&&(IOL.adv.tools.logger("set targeting for amazon video",t),a.forEach(function(e){e.hasOwnProperty("helpers")&&e.helpers.hasOwnProperty("encodedQsParams")&&IOL.adv.headerBidding.setAmazonVideoBid(e.helpers.encodedQsParams())})),googletag.cmd.push(function(){if(IOL.adv.headerBidding.enable)if(IOL.adv.headerBidding.amazon.enable&&(IOL.adv.tools.logger("set targeting for amazon display",t),apstag.setDisplayBids()),IOL.adv.headerBidding.prebidjs.enable&&(IOL.adv.tools.logger("set targeting for pbjs display and paapi",t),pbjs.setPAAPIConfigForGPT(),pbjs.setTargetingForGPTAsync(),0<Object.keys(pbjs.getBidResponses()).length&&(IOL.adv.headerBidding.prebidjs.bids=!0),"video"==IOL.adv.headerBidding.pipeline)){IOL.adv.tools.logger("HeaderBidding pipeline "+IOL.adv.headerBidding.pipeline+", skip the display strategy, callback: "+e,t),IOL.adv.complete=!0;try{"function"==typeof IamCallbackOnComplete&&(IOL.adv.tools.logger("Hook IamCallbackOnComplete in sendAdserverRequest",t),IamCallbackOnComplete())}catch(e){}}else"refresh"===IOL.adv.mode?(IOL.adv.tools.logger("Ads start displayAds after headerBidding in refreshMode",t),IOL.adv.tools.displayAds({slotContainer:IOL.adv.manager.refreshSlotsContainer.slots})):IOL.adv.pubAdsCfg.lazy?(IOL.adv.tools.logger("Start Lazy loading after header bidding",t),IOL.adv.manager.unLazySlotsContainer=[],Object.keys(IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads).forEach(function(e){var a,d=IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot].ads[e];"display"==d.mediaType&&(d.lazy?(IOL.adv.tools.logger(d.divId+", lazy enabled for this ads, start intersectionObserver",t),(a=IOL.adv.tools.divIdReady(d,!0))&&(IOL.adv.settings.lazy.observer.obj.observe(a),IOL.adv.settings.lazy.divIdSlotIdMap[d.divId]=e)):(IOL.adv.tools.logger(d.divId+", lazy disable for this ads, add to unLazySlotsContainer",t),IOL.adv.manager.slotsContainer[e]?(IOL.adv.tools.logger(e+" found in slotsContainer",t),IOL.adv.manager.unLazySlotsContainer.push(IOL.adv.manager.slotsContainer[e])):IOL.adv.tools.logger(e+" not found in slotsContainer",t)))}),0<IOL.adv.manager.unLazySlotsContainer.length&&(IOL.adv.tools.logger("start display the IOL.adv.manager.unLazySlotsContainer",t),IOL.adv.tools.displayAds({slotContainer:IOL.adv.manager.unLazySlotsContainer}))):(IOL.adv.tools.logger("displayAds after headerBidding",t),IOL.adv.tools.displayAds()),IOL.adv.tools.logger("End function",t)}),IOL.adv.settings.library.aax&&(window.aax=window.aax||{},window.aax.cmd=window.aax.cmd||[],window.aax.cmd.push(function(){window.aax.getAbpStatus()&&window.googletag.cmd.push(function(){googletag.pubads().refresh()})})))},allBiddersBack:function(){IOL.adv.headerBidding.classname;return IOL.adv.headerBidding.bidders.map(function(e){return IOL.adv.headerBidding.requestManager[e]}).filter(Boolean).length===IOL.adv.headerBidding.bidders.length},headerBidderBack:function(e,a){var d=IOL.adv.headerBidding.classname+".headerBidderBack";(IOL.adv.headerBidding.requestManager[e]=!0)!==IOL.adv.headerBidding.requestManager.adServerRequestSent&&(IOL.adv.tools.logger("HeaderBidding requestManager: "+JSON.stringify(IOL.adv.headerBidding.requestManager),d),IOL.adv.headerBidding.allBiddersBack())&&(IOL.adv.tools.logger("HeaderBidding allBiddersBack requestManager: "+JSON.stringify(IOL.adv.headerBidding.requestManager),d),IOL.adv.headerBidding.sendAdserverRequest(a))},addObjOnBidderParams:function(e){var a=IOL.adv.headerBidding.classname+".addObjOnBidderParams";try{e.bidder===this.bidder&&this.kv&&(IOL.adv.tools.logger(this.bidder+" code found, add keyValues: "+JSON.stringify(this.kv),a),e.params=Object.assign(e.params,this.kv))}catch(e){return!1}},replaceAdunitByCode:function(e){var a=IOL.adv.headerBidding.classname+".replaceAdunitByCode";try{e.code===this.code?(e.code=this.newcode,IOL.adv.tools.logger(this.code+" code found, replace prebid adUnit code",a)):IOL.adv.tools.logger(this.code+" code does not match "+e.code,a)}catch(e){return!1}},cloneAdunitByCode:function(e){var a,d=IOL.adv.headerBidding.classname+".cloneAdunitByCode";try{e.code===this.code?((a=Object.assign({},e)).code=this.newcode,IOL.adv.settings.prebidjs.adUnits.push(a),IOL.adv.tools.logger(this.code+" code found, prebid adUnit cloned",d)):IOL.adv.tools.logger(this.code+" code does not match "+e.code,d)}catch(e){return!1}},setAdunitPathByBidderCode:function(e){let a=IOL.adv.headerBidding.classname+".setAdunitPathByBidderCode";try{IOL.adv.tools.logger("Managing code: "+e.code+", try to find bidder: "+this.bidder,a),e.bids.forEach(function(e){IOL.adv.tools.logger("Compare bidder ["+e.bidder+"] with ["+this.bidder+"]",a),e.bidder==this.bidder?(e.params.adUnitPath=this.adUnitPath,IOL.adv.tools.logger(this.bidder+" bidder found, set "+e.params.adUnitPath+" as adUnitPath on "+this.code,a)):IOL.adv.tools.logger(e.bidder+" bidder does not match "+this.bidder,a)},{bidder:this.bidder,adUnitPath:this.adUnitPath,code:e.code})}catch(e){return!1}},rmAdunitByCode:function(e){var a=IOL.adv.headerBidding.classname+".rmAdunitByCode";try{return e.code===this.code?(IOL.adv.tools.logger(this.code+" code found, remove item from prebid adUnit",a),!1):(IOL.adv.tools.logger(this.code+" code does not match "+e.code,a),!0)}catch(e){return!0}},getAdunitByCode:function(e){var a=IOL.adv.headerBidding.classname+".getAdunitByCode";try{if(e.code===this.code)return IOL.adv.tools.logger(this.code+" code found, remove item from prebid adUnit",a),!0;IOL.adv.tools.logger(this.code+" code does not match "+e.code,a)}catch(e){return!0}},overridePrebidSize:function(a,t){var e,d=IOL.adv.headerBidding.classname+".overridePrebidSize";try{if(IOL.adv.tools.logger(a+" :: Try to override prebid size with "+t,d),IOL.adv.headerBidding.prebidjs.enable)return(e=IOL.adv.settings.prebidjs.adUnits.filter(e=>e.code===a)||IOL.adv.settings.prebidjs.dynamicAdUnits.filter(e=>e.code===a)).forEach(d=>{d.mediaTypes.banner.hasOwnProperty("OriginalSizeConfig")||(d.mediaTypes.banner.OriginalSizeConfig=[],d.mediaTypes.banner.sizeConfig.forEach((e,a)=>{d.mediaTypes.banner.OriginalSizeConfig[a]={...d.mediaTypes.banner.sizeConfig[a]}}));var e=Object.keys(d.mediaTypes.banner.OriginalSizeConfig).filter(e=>d.mediaTypes.banner.OriginalSizeConfig[e].minViewPort[0]===Object.keys(d.mediaTypes.banner.OriginalSizeConfig).map(e=>d.mediaTypes.banner.OriginalSizeConfig[e].minViewPort[0]).sort(function(e,a){return e-a}).filter((e,a,d)=>!(d[a]>=IOL.adv.pageWidth)).slice(-1)[0])[0];d.mediaTypes.banner.sizeConfig[e].sizes=d.mediaTypes.banner.OriginalSizeConfig[e].sizes.filter(e=>e[0]==t[0]&&e[1]==t[1])}),e;IOL.adv.tools.logger(a+" :: Prebid disabled, nothing to do",d)}catch(e){IOL.adv.tools.logger(`something went wrong for ${a}: `+e,d,"error")}},findAdunitByMediaType:function(e){var a=IOL.adv.headerBidding.classname+".findAdunitByMediaType";try{return e.mediaTypes[this.mediaType]?(IOL.adv.tools.logger(this.mediaType+" adunit found",a),!0):(IOL.adv.tools.logger(this.mediaType+" adunit not found",a),!1)}catch(e){return!1}},apstagInit:function(){var e,a=IOL.adv.headerBidding.classname+".apstagInit";IOL.adv.headerBidding.amazon.init?IOL.adv.tools.logger("apstag init already done",a):(IOL.adv.headerBidding.amazon.init=!0,e=IOL.adv.headerBidding.supplyChainSid?[{asi:"italiaonline.it",sid:IOL.adv.headerBidding.supplyChainSid,hp:1}]:[],apstag.init({pubID:IOL.adv.headerBidding.amazon.pubID,adServer:IOL.adv.headerBidding.amazon.adServer,videoAdServer:IOL.adv.headerBidding.amazon.videoAdServer,deals:IOL.adv.headerBidding.amazon.deals,useSafeFrames:!!IOL.adv.settings.hasOwnProperty("amazonUseSafeFrames")&&IOL.adv.settings.amazonUseSafeFrames,gdpr:{enabled:IOL.adv.gdpr.enable,consent:IOL.adv.gdpr.consentString},schain:{complete:1,ver:"1.0",nodes:e}}),IOL.adv.tools.logger("apstag init done",a))},isEnable:function(){var e=IOL.adv.headerBidding.classname+".isEnable";return IOL.adv.tools.logger("return: "+IOL.adv.headerBidding.enable,e),IOL.adv.headerBidding.enable},isAmazonEnable:function(){var e=IOL.adv.headerBidding.classname+".isAmazonEnable";return IOL.adv.tools.logger("return: "+IOL.adv.headerBidding.amazon.enable,e),IOL.adv.headerBidding.amazon.enable},isPrebidJsEnable:function(){var e=IOL.adv.headerBidding.classname+".isPrebidJsEnable";return IOL.adv.tools.logger("return: "+IOL.adv.headerBidding.prebidjs.enable,e),IOL.adv.headerBidding.prebidjs.enable},getAmazonVideoBid:function(){var e=IOL.adv.headerBidding.classname+".getAmazonVideoBid";return IOL.adv.tools.logger("return videoBid:"+IOL.adv.headerBidding.amazon.videoBid,e),IOL.adv.headerBidding.amazon.videoBid},setAmazonVideoBid:function(e){var a=IOL.adv.headerBidding.classname+".setAmazonVideoBid";IOL.adv.headerBidding.amazon.videoBid+=e,IOL.adv.tools.logger("videoBid:"+IOL.adv.headerBidding.amazon.videoBid,a)}}),(()=>{if(void 0!==IOL.adv)try{var a="iam.main";if(window.iamInitialized)IOL.adv.tools.logger("IAM has been already initialized",a),IOL.adv.settings.doubleInjectionHandler&&IOL.adv.settings.doubleInjectionHandler();else{if(window.iamInitialized=!0,window.googletag=window.googletag||{cmd:[]},window.googletag.cmd=window.googletag.cmd||[],window.pbjs=window.pbjs||{que:[]},Reflect.has(window,"pubAdsCfg")||(window.pubAdsCfg={}),IOL.adv.tools.objAssigner(IOL.adv.pubAdsCfg,window.pubAdsCfg),IOL.adv.tools.debugInit(),"function"==typeof IOL.adv.settings.abtest&&IOL.adv.settings.abtest(),disableHbOnConnectionType=["2g","slow-2g"],(disableHbOnConnectionType=IOL.adv.settings.disableHbOnConnectionType?disableHbOnConnectionType.concat(IOL.adv.settings.disableHbOnConnectionType):disableHbOnConnectionType).includes(IOL.adv.connectionType)&&(IOL.adv.pubAdsCfg.prebid=!1,IOL.adv.tools.logger(IOL.adv.connectionType+"::slow connection: disable headerBidding",a)),IOL.adv.tools.trkPerf("iamInjection",Math.floor(performance.now())),IOL.adv.tools.logger("connectionType: "+IOL.adv.connectionType+", downlink: "+IOL.adv.downlink+", prebid: "+IOL.adv.pubAdsCfg.prebid,a),void 0===IOL.adv.settings||IOL.adv.settings.error)throw IOL.adv.tools.trkPerf("iamErrorNameSpaceMissing",Math.floor(performance.now())),new Error("namespace missing");if(!IOL.adv.settings.slots[IOL.adv.pubAdsCfg.slot])throw IOL.adv.tools.trkPerf("iamErrorSlotDoesNotExist",Math.floor(performance.now())),new Error("slot "+IOL.adv.pubAdsCfg.slot+" does not exist");function e(e){var a=document.createElement("script"),e=(a.type="text/javascript",a.setAttribute("nonce","hsf0pBuBryPFoQqOj0RBNg"),e.hasOwnProperty("src")&&(a.src=e.src,a.async=!0),e.hasOwnProperty("innerHTML")&&(a.innerHTML=e.innerHTML),document.getElementsByTagName("head")[0]);e.parentNode.insertBefore(a,e)}IOL.adv.pubAdsCfg.deferredRun&&(IOL.adv.pubAdsCfg.deferredDisplay=!0),IOL.adv.pubAdsCfg.ut&&IOL.adv.settings.ut&&IOL.adv.tools.utHandler("disable3rdPartyLibrary"),IOL.adv.tools.logger("start loading 3rd party library",a),Object.keys(IOL.adv.settings.library).forEach(function(e){IOL.adv.settings.library[e].hasOwnProperty("gdpr")||IOL.adv.tools.inject(IOL.adv.settings.library[e])}),IOL.adv.start(),IOL.adv.tools.mEnable("antiAdBlock")&&!navigator.userAgent.includes("Google")&&(e({src:"https://fundingchoicesmessages.google.com/i/pub-2033535132705533?ers=1"}),e({innerHTML:"(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();"})),window.addEventListener("beforeunload",function(e){IOL.adv.tools.trkPerf("iamPageUnloadAdvComplete"+(IOL.adv.complete?"True":"False"),Math.floor(performance.now()),!IOL.adv.complete)})}}catch(e){IOL.adv.tools.logger(e.message||e,a,"error")}})();